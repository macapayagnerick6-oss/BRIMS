import{a as R,b as V,c as Se,d as Z,e as T,f as $,g as J,h as Ee,i as Oe,j as Me,k as U,l as te,m as Pe,n as Re,o as De,p as G,q as Te,r as Ie,s as Fe,t as I,u as ne}from"./chunk-6KDKIL6P.js";import{o as be}from"./chunk-KYS23DP7.js";import{e as we,f as Ce}from"./chunk-BRLNKSN4.js";import"./chunk-KPGMZ2XY.js";import{c as ye}from"./chunk-DUWH3AKD.js";import{$a as h,Ea as ie,Ia as X,Ja as he,O as le,Ta as L,Ua as z,Vb as ee,X as F,Xa as pe,Y as k,Ya as fe,Za as Q,_a as f,a as ce,ab as me,b as de,bb as j,cb as H,da as O,db as b,e as P,fb as ve,gb as ge,hb as xe,j as ue,jb as _e,lb as v,mb as q,xa as C}from"./chunk-PQPYQFLK.js";var ze=(function(){var r=function(n,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])},r(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}})(),ke=(function(r){ze(n,r);function n(e){var t=r.call(this,e.width,e.height)||this;return t.canvas=e,t.tempCanvasElement=null,t.buffer=n.makeBufferFromCanvasImageData(e),t}return n.makeBufferFromCanvasImageData=function(e){var t;try{t=e.getContext("2d",{willReadFrequently:!0})}catch(o){t=e.getContext("2d")}if(!t)throw new Error("Couldn't get canvas context.");var i=t.getImageData(0,0,e.width,e.height);return n.toGrayscaleBuffer(i.data,e.width,e.height)},n.toGrayscaleBuffer=function(e,t,i){for(var o=new Uint8ClampedArray(t*i),a=0,c=0,d=e.length;a<d;a+=4,c++){var s=void 0,u=e[a+3];if(u===0)s=255;else{var l=e[a],p=e[a+1],y=e[a+2];s=306*l+601*p+117*y+512>>10}o[c]=s}return o},n.prototype.getRow=function(e,t){if(e<0||e>=this.getHeight())throw new V("Requested row is outside the image: "+e);var i=this.getWidth(),o=e*i;return t===null?t=this.buffer.slice(o,o+i):(t.length<i&&(t=new Uint8ClampedArray(i)),t.set(this.buffer.slice(o,o+i))),t},n.prototype.getMatrix=function(){return this.buffer},n.prototype.isCropSupported=function(){return!0},n.prototype.crop=function(e,t,i,o){return r.prototype.crop.call(this,e,t,i,o),this},n.prototype.isRotateSupported=function(){return!0},n.prototype.rotateCounterClockwise=function(){return this.rotate(-90),this},n.prototype.rotateCounterClockwise45=function(){return this.rotate(-45),this},n.prototype.invert=function(){return new Me(this)},n.prototype.getTempCanvasElement=function(){if(this.tempCanvasElement===null){var e=this.canvas.ownerDocument.createElement("canvas");e.width=this.canvas.width,e.height=this.canvas.height,this.tempCanvasElement=e}return this.tempCanvasElement},n.prototype.rotate=function(e){var t=this.getTempCanvasElement();if(!t)throw new Error("Could not create a Canvas element.");var i=e*n.DEGREE_TO_RADIANS,o=this.canvas.width,a=this.canvas.height,c=Math.ceil(Math.abs(Math.cos(i))*o+Math.abs(Math.sin(i))*a),d=Math.ceil(Math.abs(Math.sin(i))*o+Math.abs(Math.cos(i))*a);t.width=c,t.height=d;var s=t.getContext("2d");if(!s)throw new Error("Could not create a Canvas Context element.");return s.translate(c/2,d/2),s.rotate(i),s.drawImage(this.canvas,o/-2,a/-2),this.buffer=n.makeBufferFromCanvasImageData(t),this},n.DEGREE_TO_RADIANS=Math.PI/180,n})(Oe);function oe(){return typeof navigator<"u"}function Qe(){return oe()&&!!navigator.mediaDevices}function Ae(){return!!(Qe()&&navigator.mediaDevices.enumerateDevices)}var W=function(){return W=Object.assign||function(r){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},W.apply(this,arguments)},g=function(r,n,e,t){function i(o){return o instanceof e?o:new e(function(a){a(o)})}return new(e||(e=Promise))(function(o,a){function c(u){try{s(t.next(u))}catch(l){a(l)}}function d(u){try{s(t.throw(u))}catch(l){a(l)}}function s(u){u.done?o(u.value):i(u.value).then(c,d)}s((t=t.apply(r,n||[])).next())})},x=function(r,n){var e={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},t,i,o,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(s){return function(u){return d([s,u])}}function d(s){if(t)throw new TypeError("Generator is already executing.");for(;e;)try{if(t=1,i&&(o=s[0]&2?i.return:s[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,s[1])).done)return o;switch(i=0,o&&(s=[s[0]&2,o.value]),s[0]){case 0:case 1:o=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,i=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(o=e.trys,!(o=o.length>0&&o[o.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!o||s[1]>o[0]&&s[1]<o[3])){e.label=s[1];break}if(s[0]===6&&e.label<o[1]){e.label=o[1],o=s;break}if(o&&e.label<o[2]){e.label=o[2],e.ops.push(s);break}o[2]&&e.ops.pop(),e.trys.pop();continue}s=n.call(r,e)}catch(u){s=[6,u],i=0}finally{t=o=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}},ae=function(r){var n=typeof Symbol=="function"&&Symbol.iterator,e=n&&r[n],t=0;if(e)return e.call(r);if(r&&typeof r.length=="number")return{next:function(){return r&&t>=r.length&&(r=void 0),{value:r&&r[t++],done:!r}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")},je={delayBetweenScanAttempts:500,delayBetweenScanSuccess:500,tryPlayVideoTimeout:5e3},_=(function(){function r(n,e,t){e===void 0&&(e=new Map),t===void 0&&(t={}),this.reader=n,this.hints=e,this.options=W(W({},je),t)}return Object.defineProperty(r.prototype,"possibleFormats",{set:function(n){this.hints.set(T.POSSIBLE_FORMATS,n)},enumerable:!1,configurable:!0}),r.addVideoSource=function(n,e){try{n.srcObject=e}catch(t){console.error("got interrupted by new loading request")}},r.mediaStreamSetTorch=function(n,e){return g(this,void 0,void 0,function(){return x(this,function(t){switch(t.label){case 0:return[4,n.applyConstraints({advanced:[{fillLightMode:e?"flash":"off",torch:!!e}]})];case 1:return t.sent(),[2]}})})},r.mediaStreamIsTorchCompatible=function(n){var e,t,i=n.getVideoTracks();try{for(var o=ae(i),a=o.next();!a.done;a=o.next()){var c=a.value;if(r.mediaStreamIsTorchCompatibleTrack(c))return!0}}catch(d){e={error:d}}finally{try{a&&!a.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}return!1},r.mediaStreamIsTorchCompatibleTrack=function(n){try{var e=n.getCapabilities();return"torch"in e}catch(t){return console.error(t),console.warn("Your browser may be not fully compatible with WebRTC and/or ImageCapture specs. Torch will not be available."),!1}},r.isVideoPlaying=function(n){return n.currentTime>0&&!n.paused&&n.readyState>2},r.getMediaElement=function(n,e){var t=document.getElementById(n);if(!t)throw new R("element with id '".concat(n,"' not found"));if(t.nodeName.toLowerCase()!==e.toLowerCase())throw new R("element with id '".concat(n,"' must be an ").concat(e," element"));return t},r.createVideoElement=function(n){if(n instanceof HTMLVideoElement)return n;if(typeof n=="string")return r.getMediaElement(n,"video");if(!n&&typeof document<"u"){var e=document.createElement("video");return e.width=200,e.height=200,e}throw new Error("Couldn't get videoElement from videoSource!")},r.prepareImageElement=function(n){if(n instanceof HTMLImageElement)return n;if(typeof n=="string")return r.getMediaElement(n,"img");if(typeof n>"u"){var e=document.createElement("img");return e.width=200,e.height=200,e}throw new Error("Couldn't get imageElement from imageSource!")},r.prepareVideoElement=function(n){var e=r.createVideoElement(n);return e.setAttribute("autoplay","true"),e.setAttribute("muted","true"),e.setAttribute("playsinline","true"),e},r.isImageLoaded=function(n){return!(!n.complete||n.naturalWidth===0)},r.createBinaryBitmapFromCanvas=function(n){var e=new ke(n),t=new Ee(e);return new Se(t)},r.drawImageOnCanvas=function(n,e){n.drawImage(e,0,0)},r.getMediaElementDimensions=function(n){if(n instanceof HTMLVideoElement)return{height:n.videoHeight,width:n.videoWidth};if(n instanceof HTMLImageElement)return{height:n.naturalHeight||n.height,width:n.naturalWidth||n.width};throw new Error("Couldn't find the Source's dimensions!")},r.createCaptureCanvas=function(n){if(!n)throw new R("Cannot create a capture canvas without a media element.");if(typeof document>"u")throw new Error(`The page "Document" is undefined, make sure you're running in a browser.`);var e=document.createElement("canvas"),t=r.getMediaElementDimensions(n),i=t.width,o=t.height;return e.style.width=i+"px",e.style.height=o+"px",e.width=i,e.height=o,e},r.tryPlayVideo=function(n){return g(this,void 0,void 0,function(){var e;return x(this,function(t){switch(t.label){case 0:if(n?.ended)return console.error("Trying to play video that has ended."),[2,!1];if(r.isVideoPlaying(n))return console.warn("Trying to play video that is already playing."),[2,!0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,n.play()];case 2:return t.sent(),[2,!0];case 3:return e=t.sent(),console.warn("It was not possible to play the video.",e),[2,!1];case 4:return[2]}})})},r.createCanvasFromMediaElement=function(n){var e=r.createCaptureCanvas(n),t=e.getContext("2d");if(!t)throw new Error("Couldn't find Canvas 2D Context.");return r.drawImageOnCanvas(t,n),e},r.createBinaryBitmapFromMediaElem=function(n){var e=r.createCanvasFromMediaElement(n);return r.createBinaryBitmapFromCanvas(e)},r.destroyImageElement=function(n){n.src="",n.removeAttribute("src"),n=void 0},r.listVideoInputDevices=function(){return g(this,void 0,void 0,function(){var n,e,t,i,o,a,c,d,s,u,l,p;return x(this,function(y){switch(y.label){case 0:if(!oe())throw new Error("Can't enumerate devices, navigator is not present.");if(!Ae())throw new Error("Can't enumerate devices, method not supported.");return[4,navigator.mediaDevices.enumerateDevices()];case 1:n=y.sent(),e=[];try{for(t=ae(n),i=t.next();!i.done;i=t.next())o=i.value,a=o.kind==="video"?"videoinput":o.kind,a==="videoinput"&&(c=o.deviceId||o.id,d=o.label||"Video device ".concat(e.length+1),s=o.groupId,u={deviceId:c,label:d,kind:a,groupId:s},e.push(u))}catch(D){l={error:D}}finally{try{i&&!i.done&&(p=t.return)&&p.call(t)}finally{if(l)throw l.error}}return[2,e]}})})},r.findDeviceById=function(n){return g(this,void 0,void 0,function(){var e;return x(this,function(t){switch(t.label){case 0:return[4,r.listVideoInputDevices()];case 1:return e=t.sent(),e?[2,e.find(function(i){return i.deviceId===n})]:[2]}})})},r.cleanVideoSource=function(n){if(n){try{n.srcObject=null}catch(e){n.src=""}n&&n.removeAttribute("src")}},r.releaseAllStreams=function(){r.streamTracker.length!==0&&r.streamTracker.forEach(function(n){n.getTracks().forEach(function(e){return e.stop()})}),r.streamTracker=[]},r.playVideoOnLoadAsync=function(n,e){return g(this,void 0,void 0,function(){var t;return x(this,function(i){switch(i.label){case 0:return[4,r.tryPlayVideo(n)];case 1:return t=i.sent(),t?[2,!0]:[2,new Promise(function(o,a){var c=setTimeout(function(){r.isVideoPlaying(n)||(a(!1),n.removeEventListener("canplay",d))},e),d=function(){r.tryPlayVideo(n).then(function(s){clearTimeout(c),n.removeEventListener("canplay",d),o(s)})};n.addEventListener("canplay",d)})]}})})},r.attachStreamToVideo=function(n,e,t){return t===void 0&&(t=5e3),g(this,void 0,void 0,function(){var i;return x(this,function(o){switch(o.label){case 0:return i=r.prepareVideoElement(e),r.addVideoSource(i,n),[4,r.playVideoOnLoadAsync(i,t)];case 1:return o.sent(),[2,i]}})})},r._waitImageLoad=function(n){return new Promise(function(e,t){var i=1e4,o=setTimeout(function(){r.isImageLoaded(n)||(n.removeEventListener("load",a),t())},i),a=function(){clearTimeout(o),n.removeEventListener("load",a),e()};n.addEventListener("load",a)})},r.checkCallbackFnOrThrow=function(n){if(!n)throw new R("`callbackFn` is a required parameter, you cannot capture results without it.")},r.disposeMediaStream=function(n){n.getVideoTracks().forEach(function(e){return e.stop()}),n=void 0},r.prototype.decode=function(n){var e=r.createCanvasFromMediaElement(n);return this.decodeFromCanvas(e)},r.prototype.decodeBitmap=function(n){return this.reader.decode(n,this.hints)},r.prototype.decodeFromCanvas=function(n){var e=r.createBinaryBitmapFromCanvas(n);return this.decodeBitmap(e)},r.prototype.decodeFromImageElement=function(n){return g(this,void 0,void 0,function(){var e;return x(this,function(t){switch(t.label){case 0:if(!n)throw new R("An image element must be provided.");return e=r.prepareImageElement(n),[4,this._decodeOnLoadImage(e)];case 1:return[2,t.sent()]}})})},r.prototype.decodeFromImageUrl=function(n){return g(this,void 0,void 0,function(){var e;return x(this,function(t){switch(t.label){case 0:if(!n)throw new R("An URL must be provided.");e=r.prepareImageElement(),e.src=n,t.label=1;case 1:return t.trys.push([1,,3,4]),[4,this.decodeFromImageElement(e)];case 2:return[2,t.sent()];case 3:return r.destroyImageElement(e),[7];case 4:return[2]}})})},r.prototype.decodeFromConstraints=function(n,e,t){return g(this,void 0,void 0,function(){var i,o;return x(this,function(a){switch(a.label){case 0:return r.checkCallbackFnOrThrow(t),[4,this.getUserMedia(n)];case 1:i=a.sent(),a.label=2;case 2:return a.trys.push([2,4,,5]),[4,this.decodeFromStream(i,e,t)];case 3:return[2,a.sent()];case 4:throw o=a.sent(),r.disposeMediaStream(i),o;case 5:return[2]}})})},r.prototype.decodeFromStream=function(n,e,t){return g(this,void 0,void 0,function(){var i,o,a,c,d,s,u,l,p,y=this;return x(this,function(D){switch(D.label){case 0:return r.checkCallbackFnOrThrow(t),i=this.options.tryPlayVideoTimeout,[4,r.attachStreamToVideo(n,e,i)];case 1:return o=D.sent(),a=function(){r.disposeMediaStream(n),r.cleanVideoSource(o)},c=this.scan(o,t,a),d=n.getVideoTracks(),s=W(W({},c),{stop:function(){c.stop()},streamVideoConstraintsApply:function(m,S){return g(this,void 0,void 0,function(){var w,M,E,B,Y,re,se;return x(this,function(N){switch(N.label){case 0:w=S?d.filter(S):d,N.label=1;case 1:N.trys.push([1,6,7,8]),M=ae(w),E=M.next(),N.label=2;case 2:return E.done?[3,5]:(B=E.value,[4,B.applyConstraints(m)]);case 3:N.sent(),N.label=4;case 4:return E=M.next(),[3,2];case 5:return[3,8];case 6:return Y=N.sent(),re={error:Y},[3,8];case 7:try{E&&!E.done&&(se=M.return)&&se.call(M)}finally{if(re)throw re.error}return[7];case 8:return[2]}})})},streamVideoConstraintsGet:function(m){return d.find(m).getConstraints()},streamVideoSettingsGet:function(m){return d.find(m).getSettings()},streamVideoCapabilitiesGet:function(m){return d.find(m).getCapabilities()}}),u=r.mediaStreamIsTorchCompatible(n),u&&(l=d?.find(function(m){return r.mediaStreamIsTorchCompatibleTrack(m)}),p=function(m){return g(y,void 0,void 0,function(){return x(this,function(S){switch(S.label){case 0:return[4,r.mediaStreamSetTorch(l,m)];case 1:return S.sent(),[2]}})})},s.switchTorch=p,s.stop=function(){return g(y,void 0,void 0,function(){return x(this,function(m){switch(m.label){case 0:return c.stop(),[4,p(!1)];case 1:return m.sent(),[2]}})})}),[2,s]}})})},r.prototype.decodeFromVideoDevice=function(n,e,t){return g(this,void 0,void 0,function(){var i,o;return x(this,function(a){switch(a.label){case 0:return r.checkCallbackFnOrThrow(t),n?i={deviceId:{exact:n}}:i={facingMode:"environment"},o={video:i},[4,this.decodeFromConstraints(o,e,t)];case 1:return[2,a.sent()]}})})},r.prototype.decodeFromVideoElement=function(n,e){return g(this,void 0,void 0,function(){var t,i;return x(this,function(o){switch(o.label){case 0:if(r.checkCallbackFnOrThrow(e),!n)throw new R("A video element must be provided.");return t=r.prepareVideoElement(n),i=this.options.tryPlayVideoTimeout,[4,r.playVideoOnLoadAsync(t,i)];case 1:return o.sent(),[2,this.scan(t,e)]}})})},r.prototype.decodeFromVideoUrl=function(n,e){return g(this,void 0,void 0,function(){var t,i,o,a;return x(this,function(c){switch(c.label){case 0:if(r.checkCallbackFnOrThrow(e),!n)throw new R("An URL must be provided.");return t=r.prepareVideoElement(),t.src=n,i=function(){r.cleanVideoSource(t)},o=this.options.tryPlayVideoTimeout,[4,r.playVideoOnLoadAsync(t,o)];case 1:return c.sent(),a=this.scan(t,e,i),[2,a]}})})},r.prototype.decodeOnceFromConstraints=function(n,e){return g(this,void 0,void 0,function(){var t;return x(this,function(i){switch(i.label){case 0:return[4,this.getUserMedia(n)];case 1:return t=i.sent(),[4,this.decodeOnceFromStream(t,e)];case 2:return[2,i.sent()]}})})},r.prototype.decodeOnceFromStream=function(n,e){return g(this,void 0,void 0,function(){var t,i,o;return x(this,function(a){switch(a.label){case 0:return t=!!e,[4,r.attachStreamToVideo(n,e)];case 1:i=a.sent(),a.label=2;case 2:return a.trys.push([2,,4,5]),[4,this.scanOneResult(i)];case 3:return o=a.sent(),[2,o];case 4:return t||r.cleanVideoSource(i),[7];case 5:return[2]}})})},r.prototype.decodeOnceFromVideoDevice=function(n,e){return g(this,void 0,void 0,function(){var t,i;return x(this,function(o){switch(o.label){case 0:return n?t={deviceId:{exact:n}}:t={facingMode:"environment"},i={video:t},[4,this.decodeOnceFromConstraints(i,e)];case 1:return[2,o.sent()]}})})},r.prototype.decodeOnceFromVideoElement=function(n){return g(this,void 0,void 0,function(){var e,t;return x(this,function(i){switch(i.label){case 0:if(!n)throw new R("A video element must be provided.");return e=r.prepareVideoElement(n),t=this.options.tryPlayVideoTimeout,[4,r.playVideoOnLoadAsync(e,t)];case 1:return i.sent(),[4,this.scanOneResult(e)];case 2:return[2,i.sent()]}})})},r.prototype.decodeOnceFromVideoUrl=function(n){return g(this,void 0,void 0,function(){var e,t;return x(this,function(i){switch(i.label){case 0:if(!n)throw new R("An URL must be provided.");e=r.prepareVideoElement(),e.src=n,t=this.decodeOnceFromVideoElement(e),i.label=1;case 1:return i.trys.push([1,,3,4]),[4,t];case 2:return[2,i.sent()];case 3:return r.cleanVideoSource(e),[7];case 4:return[2]}})})},r.prototype.scanOneResult=function(n,e,t,i){var o=this;return e===void 0&&(e=!0),t===void 0&&(t=!0),i===void 0&&(i=!0),new Promise(function(a,c){o.scan(n,function(d,s,u){if(d){a(d),u.stop();return}if(s){if(s instanceof J&&e||s instanceof Z&&t||s instanceof $&&i)return;u.stop(),c(s)}})})},r.prototype.scan=function(n,e,t){var i=this;r.checkCallbackFnOrThrow(e);var o=r.createCaptureCanvas(n),a;try{a=o.getContext("2d",{willReadFrequently:!0})}catch(y){a=o.getContext("2d")}if(!a)throw new Error("Couldn't create canvas for visual element scan.");var c=function(){a=void 0,o=void 0},d=!1,s,u=function(){d=!0,clearTimeout(s),c(),t&&t()},l={stop:u},p=function(){if(!d)try{r.drawImageOnCanvas(a,n);var y=i.decodeFromCanvas(o);e(y,void 0,l),s=setTimeout(p,i.options.delayBetweenScanSuccess)}catch(w){e(void 0,w,l);var D=w instanceof Z,m=w instanceof $,S=w instanceof J;if(D||m||S){s=setTimeout(p,i.options.delayBetweenScanAttempts);return}c(),t&&t(w)}};return p(),l},r.prototype._decodeOnLoadImage=function(n){return g(this,void 0,void 0,function(){var e;return x(this,function(t){switch(t.label){case 0:return e=r.isImageLoaded(n),e?[3,2]:[4,r._waitImageLoad(n)];case 1:t.sent(),t.label=2;case 2:return[2,this.decode(n)]}})})},r.prototype.getUserMedia=function(n){return g(this,void 0,void 0,function(){var e;return x(this,function(t){switch(t.label){case 0:return[4,navigator.mediaDevices.getUserMedia(n)];case 1:return e=t.sent(),r.streamTracker.push(e),[2,e]}})})},r.streamTracker=[],r})();var He=(function(){var r=function(n,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])},r(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}})(),vt=(function(r){He(n,r);function n(e,t){return r.call(this,new Pe,e,t)||this}return n})(_);var qe=(function(){var r=function(n,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])},r(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}})(),wt=(function(r){qe(n,r);function n(e,t){return r.call(this,new Re(e),e,t)||this}return n})(_);var Ue=(function(){var r=function(n,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])},r(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}})(),St=(function(r){Ue(n,r);function n(e,t){return r.call(this,new De,e,t)||this}return n})(_);var Ge=(function(){var r=function(n,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])},r(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}})(),Ve=(function(r){Ge(n,r);function n(e,t){var i=this,o=new Fe;return o.setHints(e),i=r.call(this,o,e,t)||this,i.reader=o,i}return Object.defineProperty(n.prototype,"possibleFormats",{set:function(e){this.hints.set(T.POSSIBLE_FORMATS,e),this.reader.setHints(this.hints)},enumerable:!1,configurable:!0}),n.prototype.decodeBitmap=function(e){return this.reader.decodeWithState(e)},n.prototype.setHints=function(e){this.hints=e,this.reader.setHints(this.hints)},n})(_);var We=(function(){var r=function(n,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])},r(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}})(),Tt=(function(r){We(n,r);function n(e,t){return r.call(this,new Ie,e,t)||this}return n})(_);var Ze=(function(){var r=function(n,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])},r(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}})(),At=(function(r){Ze(n,r);function n(e,t){return r.call(this,new Te,e,t)||this}return n})(_);var A="http://www.w3.org/2000/svg",Nt=(function(){function r(n){if(typeof n=="string"){var e=document.getElementById(n);if(!e)throw new Error("Could not find a Container element with '".concat(n,"'."));this.containerElement=e}else this.containerElement=n}return r.prototype.write=function(n,e,t,i){if(n.length===0)throw new V("Found empty contents");if(e<0||t<0)throw new V("Requested dimensions are too small: "+e+"x"+t);var o=i&&i.get(I.MARGIN)!==void 0?Number.parseInt(i.get(I.MARGIN).toString(),10):r.QUIET_ZONE_SIZE,a=this.encode(i,n);return this.renderResult(a,e,t,o)},r.prototype.createSVGElement=function(n,e){var t=document.createElementNS(r.SVG_NS,"svg");return t.setAttributeNS(A,"width",e.toString()),t.setAttributeNS(A,"height",n.toString()),t},r.prototype.createSvgPathPlaceholderElement=function(n,e){var t=document.createElementNS(r.SVG_NS,"path");return t.setAttributeNS(A,"d","M0 0h".concat(n,"v").concat(e,"H0z")),t.setAttributeNS(A,"fill","none"),t},r.prototype.createSvgRectElement=function(n,e,t,i){var o=document.createElementNS(r.SVG_NS,"rect");return o.setAttributeNS(A,"x",n.toString()),o.setAttributeNS(A,"y",e.toString()),o.setAttributeNS(A,"height",t.toString()),o.setAttributeNS(A,"width",i.toString()),o.setAttributeNS(A,"fill","#000000"),o},r.prototype.encode=function(n,e){var t=G.L;if(n&&n.get(I.ERROR_CORRECTION)!==void 0){var i=n.get(I.ERROR_CORRECTION).toString();t=G.fromString(i)}var o=ne.encode(e,t,n);return o},r.prototype.renderResult=function(n,e,t,i){var o=n.getMatrix();if(o===null)throw new te;var a=o.getWidth(),c=o.getHeight(),d=a+i*2,s=c+i*2,u=Math.max(e,d),l=Math.max(t,s),p=Math.min(Math.floor(u/d),Math.floor(l/s)),y=Math.floor((u-a*p)/2),D=Math.floor((l-c*p)/2),m=this.createSVGElement(u,l),S=this.createSvgPathPlaceholderElement(e,t);m.appendChild(S),this.containerElement.appendChild(m);for(var w=0,M=D;w<c;w++,M+=p)for(var E=0,B=y;E<a;E++,B+=p)if(o.get(E,w)===1){var Y=this.createSvgRectElement(B,M,p,p);m.appendChild(Y)}return m},r.QUIET_ZONE_SIZE=4,r.SVG_NS="http://www.w3.org/2000/svg",r})();var Be="http://www.w3.org/2000/svg",Qt=(function(){function r(){}return r.prototype.write=function(n,e,t,i){if(n.length===0)throw new V("Found empty contents");if(e<0||t<0)throw new V("Requested dimensions are too small: "+e+"x"+t);var o=G.L,a=r.QUIET_ZONE_SIZE;if(i){if(i.get(I.ERROR_CORRECTION)!==void 0){var c=i.get(I.ERROR_CORRECTION).toString();o=G.fromString(c)}i.get(I.MARGIN)!==void 0&&(a=Number.parseInt(i.get(I.MARGIN).toString(),10))}var d=ne.encode(n,o,i);return this.renderResult(d,e,t,a)},r.prototype.writeToDom=function(n,e,t,i,o){if(typeof n=="string"){var a=document.querySelector(n);if(!a)throw new Error("Could no find the target HTML element.");n=a}var c=this.write(e,t,i,o);n instanceof HTMLElement&&n.appendChild(c)},r.prototype.renderResult=function(n,e,t,i){var o=n.getMatrix();if(o===null)throw new te;for(var a=o.getWidth(),c=o.getHeight(),d=a+i*2,s=c+i*2,u=Math.max(e,d),l=Math.max(t,s),p=Math.min(Math.floor(u/d),Math.floor(l/s)),y=Math.floor((u-a*p)/2),D=Math.floor((l-c*p)/2),m=this.createSVGElement(u,l),S=0,w=D;S<c;S++,w+=p)for(var M=0,E=y;M<a;M++,E+=p)if(o.get(M,S)===1){var B=this.createSvgRectElement(E,w,p,p);m.appendChild(B)}return m},r.prototype.createSVGElement=function(n,e){var t=document.createElementNS(Be,"svg"),i=n.toString(),o=e.toString();return t.setAttribute("height",o),t.setAttribute("width",i),t.setAttribute("viewBox","0 0 "+i+" "+o),t},r.prototype.createSvgRectElement=function(n,e,t,i){var o=document.createElementNS(Be,"rect");return o.setAttribute("x",n.toString()),o.setAttribute("y",e.toString()),o.setAttribute("height",t.toString()),o.setAttribute("width",i.toString()),o.setAttribute("fill","#000000"),o},r.QUIET_ZONE_SIZE=4,r})();var Je=["preview"],K=class extends Ve{getScannerControls(){if(!this.scannerControls)throw new Error("No scanning is running at the time.");return this.scannerControls}scanFromDeviceObservable(n,e){return P(this,null,function*(){let t=new ue({}),i;try{i=yield this.decodeFromVideoDevice(n,e,(o,a)=>{if(!a){t.next({result:o});return}let c=a.name;if(c===J.name||c===Z.name||c===$.name||a.message.includes("No MultiFormat Readers were able to detect the code.")){t.next({error:a});return}t.error(a),this.scannerControls.stop(),this.scannerControls=void 0}),this.scannerControls=de(ce({},i),{stop(){i.stop(),t.complete()}})}catch(o){t.error(o),this.scannerControls?.stop(),this.scannerControls=void 0}return t.asObservable()})}},Ne=(()=>{class r{get codeReader(){return this._codeReader}set device(e){if(!this._ready){this._devicePreStart=e;return}if(this.isAutostarting){console.warn("Avoid setting a device during auto-start.");return}if(this.isCurrentDevice(e)){console.warn("Setting the same device is not allowed.");return}if(!this.hasPermission){console.warn("Permissions not set yet, waiting for them to be set to apply device change.");return}this.setDevice(e)}get device(){return this._device}get formats(){return this.hints.get(T.POSSIBLE_FORMATS)}set formats(e){if(typeof e=="string")throw new Error("Invalid formats, make sure the [formats] input is a binding.");let t=e.map(o=>this.getBarcodeFormatOrFail(o)),i=this.hints;i.set(T.POSSIBLE_FORMATS,t),this.hints=i}get hints(){return this._hints}set hints(e){this._hints=e,this.codeReader?.setHints(this._hints)}set videoConstraints(e){let t=this.codeReader?.getScannerControls();t&&t?.streamVideoConstraintsApply(e)}set isAutostarting(e){this._isAutostarting=e,this.autostarting.next(e)}get isAutostarting(){return this._isAutostarting}set torch(e){try{this.getCodeReader().getScannerControls().switchTorch(e)}catch(t){}}set enable(e){this._enabled!==!!e&&(this._enabled=!!e,this._enabled?this.device?this.scanFromDevice(this.device.deviceId):this.init():(this.reset(),K.releaseAllStreams()))}get enabled(){return this._enabled}get tryHarder(){return this.hints.get(T.TRY_HARDER)}set tryHarder(e){let t=this.hints;e?t.set(T.TRY_HARDER,!0):t.delete(T.TRY_HARDER),this.hints=t}constructor(){this.timeBetweenScans=500,this.delayBetweenScanSuccess=500,this.previewFitMode="cover",this.poster="",this._ready=!1,this.autostarted=new O,this.autostarting=new O,this.torchCompatible=new O(!1),this.scanSuccess=new O,this.scanFailure=new O,this.scanError=new O,this.scanComplete=new O,this.camerasFound=new O,this.camerasNotFound=new O,this.permissionResponse=new O(!0),this.hasDevices=new O,this.deviceChange=new O,this._enabled=!0,this._hints=new Map,this.autofocusEnabled=!0,this.autostart=!0,this.formats=[U.QR_CODE],this.hasNavigator=typeof navigator<"u",this.isMediaDevicesSupported=this.hasNavigator&&!!navigator.mediaDevices}askForPermission(){return P(this,null,function*(){if(!this.hasNavigator)return console.error("@zxing/ngx-scanner","Can't ask permission, navigator is not present."),this.setPermission(null),this.hasPermission;if(!this.isMediaDevicesSupported)return console.error("@zxing/ngx-scanner","Can't get user media, this is not supported."),this.setPermission(null),this.hasPermission;let e,t;try{e=yield this.getAnyVideoDevice(),t=!!e}catch(i){return this.handlePermissionException(i)}finally{this.terminateStream(e)}return this.setPermission(t),t})}getAnyVideoDevice(){return navigator.mediaDevices.getUserMedia({video:!0})}terminateStream(e){e&&e.getTracks().forEach(t=>t.stop()),e=void 0}init(){return P(this,null,function*(){if(!this.autostart){console.warn("Feature 'autostart' disabled. Permissions and devices recovery has to be run manually."),this.initAutostartOff(),this._ready=!0;return}yield this.initAutostartOn(),this._ready=!0})}initAutostartOff(){this.isAutostarting=!1,this.updateVideoInputDevices(),this._device&&this._devicePreStart&&this.setDevice(this._devicePreStart)}initAutostartOn(){return P(this,null,function*(){this.isAutostarting=!0;let e;try{e=yield this.askForPermission()}catch(t){console.error("Exception occurred while asking for permission:",t);return}if(e){let t=yield this.updateVideoInputDevices();yield this.autostartScanner([...t])}this.isAutostarting=!1,this.autostarted.next()})}isCurrentDevice(e){return e?.deviceId===this._device?.deviceId}ngOnDestroy(){this.reset(),_.cleanVideoSource(this.previewElemRef.nativeElement),K.releaseAllStreams()}ngOnInit(){this.init()}scanStop(){this._scanSubscription&&(this.codeReader?.getScannerControls().stop(),this._scanSubscription?.unsubscribe(),this._scanSubscription=void 0)}scanStart(){if(this._scanSubscription)throw new Error("There is already a scan process running.");if(!this._device)throw new Error("No device defined, cannot start scan, please define a device.");this.scanFromDevice(this._device.deviceId)}restart(){this._codeReader=void 0;let e=this._reset();e&&(this.device=e)}updateVideoInputDevices(){return P(this,null,function*(){let e=(yield _.listVideoInputDevices())||[],t=e&&e.length>0;return this.hasDevices.next(t),this.camerasFound.next([...e]),t||this.camerasNotFound.next(null),e})}autostartScanner(e){return P(this,null,function*(){let t=({label:o})=>/back|trÃ¡s|rear|traseira|environment|ambiente/gi.test(o),i=e.find(t)||e.pop();if(!i)throw new Error("Impossible to autostart, no input devices available.");yield this.setDevice(i),this.deviceChange.next(i)})}dispatchScanSuccess(e){this.scanSuccess.next(e.getText())}dispatchScanFailure(e){this.scanFailure.next(e)}dispatchScanError(e){this.scanError.observed||(console.error(`zxing scanner component: ${e.name}`,e),console.warn("Use the `(scanError)` property to handle errors like this!")),this.scanError.next(e)}dispatchScanComplete(e){this.scanComplete.next(e)}handlePermissionException(e){console.error("@zxing/ngx-scanner","Error when asking for permission.",e);let t;switch(e.name){case"NotSupportedError":console.warn("@zxing/ngx-scanner",e.message),t=null,this.hasDevices.next(null);break;case"NotAllowedError":console.warn("@zxing/ngx-scanner",e.message),t=!1,this.hasDevices.next(!0);break;case"NotFoundError":console.warn("@zxing/ngx-scanner",e.message),t=null,this.hasDevices.next(!1),this.camerasNotFound.next(e);break;case"NotReadableError":console.warn("@zxing/ngx-scanner","Couldn't read the device(s)'s stream, it's probably in use by another app."),t=null,this.hasDevices.next(!1),this.camerasNotFound.next(e);break;case"AbortError":console.warn("@zxing/ngx-scanner","It seems that the required permissions have been granted, but something else failed",e),t=!0,this.hasDevices.next(null),this.camerasNotFound.next(e);break;default:console.warn("@zxing/ngx-scanner","I was not able to define if I have permissions for camera or not.",e),t=null;break}return this.setPermission(t),this.permissionResponse.error(e),t}getBarcodeFormatOrFail(e){return typeof e=="string"?U[e.trim().toUpperCase()]:e}getCodeReader(){if(!this._codeReader){let e={delayBetweenScanAttempts:this.timeBetweenScans,delayBetweenScanSuccess:this.delayBetweenScanSuccess};this._codeReader=new K(this.hints,e)}return this._codeReader}scanFromDevice(e){return P(this,null,function*(){let t=this.previewElemRef.nativeElement,i=this.getCodeReader(),o=yield i.scanFromDeviceObservable(e,t);if(!o)throw new Error("Undefined decoding stream, aborting.");let a=l=>this._onDecodeResult(l.result,l.error),c=l=>this._onDecodeError(l),d=()=>{};if(this._scanSubscription=o.subscribe(a,c,d),this._scanSubscription.closed)return;let u=typeof i.getScannerControls().switchTorch<"u";this.torchCompatible.next(u)})}_onDecodeError(e){this.dispatchScanError(e)}_onDecodeResult(e,t){e?this.dispatchScanSuccess(e):this.dispatchScanFailure(t),this.dispatchScanComplete(e)}_reset(){if(!this._codeReader)return;this.scanStop();try{let t=this.previewElemRef.nativeElement;_.cleanVideoSource(t)}catch(t){}try{_.releaseAllStreams()}catch(t){}this._codeReader=void 0;let e=this._device;return this.device=void 0,e}reset(){this._reset(),this.deviceChange.emit(null)}setDevice(e){return P(this,null,function*(){this.scanStop(),this._device=e||void 0,this._device||_.cleanVideoSource(this.previewElemRef.nativeElement),this._enabled&&e&&(yield this.scanFromDevice(e.deviceId))})}setPermission(e){this.hasPermission=e,this.permissionResponse.next(e)}static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275cmp=X({type:r,selectors:[["zxing-scanner"]],viewQuery:function(t,i){if(t&1&&ve(Je,7),t&2){let o;ge(o=xe())&&(i.previewElemRef=o.first)}},inputs:{autofocusEnabled:"autofocusEnabled",timeBetweenScans:"timeBetweenScans",delayBetweenScanSuccess:"delayBetweenScanSuccess",autostart:"autostart",previewFitMode:"previewFitMode",poster:"poster",device:"device",formats:"formats",videoConstraints:"videoConstraints",torch:"torch",enable:"enable",tryHarder:"tryHarder"},outputs:{autostarted:"autostarted",autostarting:"autostarting",torchCompatible:"torchCompatible",scanSuccess:"scanSuccess",scanFailure:"scanFailure",scanError:"scanError",scanComplete:"scanComplete",camerasFound:"camerasFound",camerasNotFound:"camerasNotFound",permissionResponse:"permissionResponse",hasDevices:"hasDevices",deviceChange:"deviceChange"},standalone:!1,decls:6,vars:3,consts:[["preview",""],[3,"poster"]],template:function(t,i){t&1&&(f(0,"video",1,0)(2,"p"),v(3," Your browser does not support this feature, please try to upgrade it. "),h(),f(4,"p"),v(5," Seu navegador n\xE3o suporta este recurso, por favor tente atualiz\xE1-lo. "),h()()),t&2&&(_e("object-fit",i.previewFitMode),Q("poster",i.poster))},styles:["[_nghost-%COMP%]{display:block}video[_ngcontent-%COMP%]{width:100%;height:auto;object-fit:contain}"],changeDetection:0})}}return r})(),Le=(()=>{class r{static{this.\u0275fac=function(t){return new(t||r)}}static{this.\u0275mod=he({type:r})}static{this.\u0275inj=le({imports:[ee,be]})}}return r})();var Ye=(r,n)=>n.deviceId;function Xe(r,n){if(r&1){let e=j();f(0,"div",6)(1,"div",9),v(2,"\u{1F4F7}"),h(),f(3,"h2"),v(4,"Camera Permission Required"),h(),f(5,"p"),v(6,"Please allow camera access to scan QR codes."),h(),f(7,"button",10),H("click",function(){F(e);let i=b();return k(i.retryPermission())}),v(8," Grant Permission "),h()()}}function et(r,n){if(r&1&&(f(0,"option",29),v(1),h()),r&2){let e=n.$implicit,t=n.$index;Q("value",e.deviceId),C(),q(e.label||"Camera "+(t+1))}}function tt(r,n){if(r&1){let e=j();f(0,"div",24)(1,"label",26)(2,"span",27),v(3,"\u{1F4F7}"),h(),v(4," Camera "),h(),f(5,"select",28),H("change",function(i){F(e);let o=b(2);return k(o.onDeviceSelectChange(i.target.value))}),pe(6,et,2,2,"option",29,Ye),h()()}if(r&2){let e=b(2);C(5),Q("value",(e.selectedDevice==null?null:e.selectedDevice.deviceId)||""),C(),fe(e.availableDevices)}}function nt(r,n){if(r&1){let e=j();f(0,"button",30),H("click",function(){F(e);let i=b(2);return k(i.toggleTorch())}),f(1,"span",31),v(2),h(),f(3,"span"),v(4),h()()}if(r&2){let e=b(2);C(2),q(e.torchEnabled?"\u{1F526}":"\u{1F4A1}"),C(2),q(e.torchEnabled?"Turn Off Flash":"Turn On Flash")}}function rt(r,n){if(r&1){let e=j();f(0,"div",7)(1,"div",11)(2,"zxing-scanner",12),H("torchCompatible",function(i){F(e);let o=b();return k(o.onTorchCompatible(i))})("camerasFound",function(i){F(e);let o=b();return k(o.onCamerasFound(i))})("scanSuccess",function(i){F(e);let o=b();return k(o.onScanSuccess(i))})("scanError",function(i){F(e);let o=b();return k(o.onScanError(i))}),h(),f(3,"div",13)(4,"div",14)(5,"div",15),me(6,"div",16)(7,"div",17)(8,"div",18)(9,"div",19),h()(),f(10,"p",20)(11,"span",21),v(12,"\u{1F4F1}"),h(),v(13," Position QR code within the frame "),h()()(),f(14,"div",22)(15,"div",23),L(16,tt,8,1,"div",24),L(17,nt,5,2,"button",25),h()()()}if(r&2){let e=b();C(2),Q("enable",e.scannerEnabled)("device",e.selectedDevice)("formats",e.allowedFormats)("torch",e.torchEnabled),C(14),z(e.availableDevices.length>1?16:-1),C(),z(e.torchAvailable?17:-1)}}function it(r,n){if(r&1&&(f(0,"p",36),v(1),h()),r&2){let e=b(2);C(),q(e.scanError)}}function ot(r,n){r&1&&(f(0,"p",37),v(1,"Processing..."),h())}function at(r,n){if(r&1){let e=j();f(0,"div",8)(1,"div",32)(2,"h3"),v(3,"QR Code Scanned!"),h(),f(4,"button",33),H("click",function(){F(e);let i=b();return k(i.resetScanner())}),v(5," Scan Another "),h()(),f(6,"div",34)(7,"p",35),v(8),h(),L(9,it,2,1,"p",36)(10,ot,2,0,"p",37),h()()}if(r&2){let e=b();C(8),q(e.scanResult),C(),z(e.scanError?9:10)}}var Sn=(()=>{class r{constructor(e,t){this.router=e,this.data=t,this.scannerEnabled=!1,this.hasPermission=!1,this.availableDevices=[],this.selectedDevice=void 0,this.scanResult=null,this.scanError=null,this.allowedFormats=[U.QR_CODE],this.torchEnabled=!1,this.torchAvailable=!1}ngOnInit(){this.requestCameraPermission()}ngOnDestroy(){this.scannerEnabled=!1}requestCameraPermission(){return P(this,null,function*(){try{(yield navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(t=>t.stop()),this.hasPermission=!0,this.scannerEnabled=!0}catch(e){this.hasPermission=!1,this.scanError="Camera permission denied. Please enable camera access in your browser settings.",console.error("Camera permission error:",e)}})}onCamerasFound(e){this.availableDevices=e;let t=e.find(i=>i.label.toLowerCase().includes("back")||i.label.toLowerCase().includes("rear")||i.label.toLowerCase().includes("environment"));this.selectedDevice=t||e[0]||void 0}onDeviceSelectChange(e){this.selectedDevice=this.availableDevices.find(t=>t.deviceId===e)||void 0}onScanSuccess(e){let t=typeof e=="string"?e:e.getText();this.scanResult=t,this.scanError=null,this.scanResult&&this.processScannedCode(this.scanResult)}onScanError(e){this.hasPermission&&console.error("Scan error:",e)}onTorchCompatible(e){this.torchAvailable=e}toggleTorch(){this.torchEnabled=!this.torchEnabled}processScannedCode(e){try{let t;try{t=JSON.parse(e)}catch(o){t=null}if(t){if(t.type==="resident"){let o=t.id||t.residentId;if(o){let a=this.data.getResidentById(o)||this.data.getResidentByResidentId(o);a?this.router.navigate(["/staff/residents",a.id]):this.scanError=`Resident not found for ID "${o}"`;return}}if(t.type==="request"&&t.id){let o=this.data.getRequestById(t.id);o?this.router.navigate(["/staff/requests",o.id]):this.scanError=`Request not found for ID "${t.id}"`;return}if(t.type==="certificate"&&t.id){let o=this.data.getRequestById(t.id);o?this.router.navigate(["/staff/requests",o.id]):this.scanError=`Certificate not found for ID "${t.id}"`;return}}let i=this.data.getResidentById(e)||this.data.getResidentByResidentId(e);if(i){this.router.navigate(["/staff/residents",i.id]);return}if(e.startsWith("REQ-")||e.startsWith("req-")){let o=e.replace(/^(REQ-|req-)/i,""),a=this.data.getRequestById(o);a?this.router.navigate(["/staff/requests",a.id]):this.scanError=`Request not found for ID "${o}"`;return}this.scanError=`Unrecognized QR code format: ${e}`}catch(t){this.scanError="Error processing QR code",console.error("Process error:",t)}}resetScanner(){this.scanResult=null,this.scanError=null,this.scannerEnabled=!0}retryPermission(){this.requestCameraPermission()}static{this.\u0275fac=function(t){return new(t||r)(ie(we),ie(ye))}}static{this.\u0275cmp=X({type:r,selectors:[["app-qr-scanner"]],decls:12,vars:3,consts:[[1,"qr-scanner"],[1,"page-header"],[1,"page-title"],["routerLink","/staff/dashboard",1,"back-button"],[1,"back-button__icon"],[1,"back-button__text"],[1,"permission-card","card"],[1,"scanner-container"],[1,"scan-result","card"],[1,"permission-icon"],["type","button",1,"btn","btn--primary",3,"click"],[1,"scanner-wrapper"],[1,"scanner",3,"torchCompatible","camerasFound","scanSuccess","scanError","enable","device","formats","torch"],[1,"scanner-overlay"],[1,"scanner-frame"],[1,"scanner-frame__corners"],[1,"corner","corner--top-left"],[1,"corner","corner--top-right"],[1,"corner","corner--bottom-left"],[1,"corner","corner--bottom-right"],[1,"scanner-instruction"],[1,"scanner-instruction__icon"],[1,"scanner-controls"],[1,"scanner-controls__row"],[1,"control-group"],["type","button",1,"btn","btn--secondary","btn--icon"],["for","camera-select"],[1,"control-label__icon"],["id","camera-select",1,"form-control",3,"change","value"],[3,"value"],["type","button",1,"btn","btn--secondary","btn--icon",3,"click"],[1,"btn-icon"],[1,"scan-result__header"],["type","button",1,"btn","btn--sm","btn--secondary",3,"click"],[1,"scan-result__content"],[1,"scan-result__code"],[1,"scan-result__error"],[1,"scan-result__success"]],template:function(t,i){t&1&&(f(0,"div",0)(1,"div",1)(2,"h1",2),v(3,"QR Code Scanner"),h(),f(4,"a",3)(5,"span",4),v(6,"\u2190"),h(),f(7,"span",5),v(8,"Back"),h()()(),L(9,Xe,9,0,"div",6),L(10,rt,18,6,"div",7),L(11,at,11,2,"div",8),h()),t&2&&(C(9),z(i.hasPermission?-1:9),C(),z(i.hasPermission&&i.scannerEnabled?10:-1),C(),z(i.scanResult?11:-1))},dependencies:[ee,Ce,Le,Ne],styles:['@charset "UTF-8";.qr-scanner[_ngcontent-%COMP%]{padding:24px;max-width:100%;position:relative}@media(max-width:640px){.qr-scanner[_ngcontent-%COMP%]{padding:16px}}.page-header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:24px}@media(max-width:640px){.page-header[_ngcontent-%COMP%]{margin-bottom:16px;flex-wrap:wrap;gap:.75rem}}.qr-scanner[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{position:absolute;top:16px;right:24px}@media(max-width:640px){.qr-scanner[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{top:12px;right:16px}}.page-title[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:700;color:var(--color-text);margin:0}@media(max-width:640px){.page-title[_ngcontent-%COMP%]{font-size:1.5rem}}.back-button[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:8px;padding:8px 16px;border-radius:var(--radius);background:var(--color-bg-card);color:var(--color-text);text-decoration:none;font-size:.9375rem;font-weight:500;transition:background .2s,filter .2s;border:1px solid var(--color-border)}.back-button[_ngcontent-%COMP%]:hover{filter:brightness(.95)}@media(max-width:640px){.back-button[_ngcontent-%COMP%]{padding:6px 12px;font-size:.875rem}}.back-button__icon[_ngcontent-%COMP%]{font-size:1.125rem}.permission-card[_ngcontent-%COMP%]{text-align:center;padding:48px 32px;max-width:450px;margin:0 auto}@media(max-width:640px){.permission-card[_ngcontent-%COMP%]{padding:32px 24px;max-width:100%}}.permission-icon[_ngcontent-%COMP%]{font-size:5rem;margin-bottom:24px;display:inline-block;animation:_ngcontent-%COMP%_pulse-icon 2s ease-in-out infinite}@media(max-width:640px){.permission-icon[_ngcontent-%COMP%]{font-size:4rem;margin-bottom:20px}}@keyframes _ngcontent-%COMP%_pulse-icon{0%,to{transform:scale(1)}50%{transform:scale(1.1)}}.permission-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.75rem;font-weight:600;color:var(--color-text);margin:0 0 12px}@media(max-width:640px){.permission-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:1.5rem}}.permission-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:var(--color-text-muted);margin:0 0 32px;font-size:1rem;line-height:1.6}@media(max-width:640px){.permission-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9375rem;margin-bottom:24px}}.scanner-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:32px;max-width:800px;margin:0 auto}@media(max-width:768px){.scanner-container[_ngcontent-%COMP%]{gap:24px}}.scanner-wrapper[_ngcontent-%COMP%]{position:relative;width:100%;max-width:600px;margin:0 auto;border-radius:var(--radius-lg);overflow:hidden;background:#000;aspect-ratio:1;box-shadow:0 8px 32px #0000004d}@media(max-width:640px){.scanner-wrapper[_ngcontent-%COMP%]{max-width:100%;border-radius:var(--radius)}}.scanner[_ngcontent-%COMP%]{width:100%;height:100%;display:block;object-fit:cover}.scanner-overlay[_ngcontent-%COMP%]{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;pointer-events:none;padding:20px}.scanner-frame[_ngcontent-%COMP%]{width:70%;max-width:300px;aspect-ratio:1;position:relative;display:flex;align-items:center;justify-content:center}.scanner-frame[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;border:2px solid rgba(59,130,246,.8);border-radius:16px;box-shadow:0 0 0 9999px #0009,0 0 30px #3b82f666,inset 0 0 30px #3b82f633;animation:_ngcontent-%COMP%_pulse 2s ease-in-out infinite}@keyframes _ngcontent-%COMP%_pulse{0%,to{box-shadow:0 0 0 9999px #0009,0 0 30px #3b82f666,inset 0 0 30px #3b82f633}50%{box-shadow:0 0 0 9999px #0009,0 0 40px #3b82f699,inset 0 0 40px #3b82f64d}}.scanner-frame__corners[_ngcontent-%COMP%]{position:absolute;inset:0;pointer-events:none}.corner[_ngcontent-%COMP%]{position:absolute;width:40px;height:40px;border:3px solid #3b82f6}.corner--top-left[_ngcontent-%COMP%]{top:-3px;left:-3px;border-right:none;border-bottom:none;border-top-left-radius:12px}.corner--top-right[_ngcontent-%COMP%]{top:-3px;right:-3px;border-left:none;border-bottom:none;border-top-right-radius:12px}.corner--bottom-left[_ngcontent-%COMP%]{bottom:-3px;left:-3px;border-right:none;border-top:none;border-bottom-left-radius:12px}.corner--bottom-right[_ngcontent-%COMP%]{bottom:-3px;right:-3px;border-left:none;border-top:none;border-bottom-right-radius:12px}.scanner-instruction[_ngcontent-%COMP%]{margin-top:32px;color:#fff;font-size:1rem;font-weight:500;text-align:center;text-shadow:0 2px 8px rgba(0,0,0,.7);display:flex;align-items:center;gap:8px;background:#00000080;padding:12px 20px;border-radius:24px;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}@media(max-width:640px){.scanner-instruction[_ngcontent-%COMP%]{font-size:.9375rem;margin-top:24px;padding:10px 16px}}.scanner-instruction__icon[_ngcontent-%COMP%]{font-size:1.25rem;animation:_ngcontent-%COMP%_bounce 2s ease-in-out infinite}@keyframes _ngcontent-%COMP%_bounce{0%,to{transform:translateY(0)}50%{transform:translateY(-5px)}}.scanner-controls[_ngcontent-%COMP%]{max-width:600px;margin:0 auto;width:100%}.scanner-controls__row[_ngcontent-%COMP%]{display:flex;gap:16px;align-items:flex-end}@media(max-width:640px){.scanner-controls__row[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}}.control-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;flex:1}@media(max-width:640px){.control-group[_ngcontent-%COMP%]{flex:none}}.control-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:var(--color-text);display:flex;align-items:center;gap:6px}.control-label__icon[_ngcontent-%COMP%]{font-size:1rem}.form-control[_ngcontent-%COMP%]{padding:10px 14px;border:1px solid var(--color-border);border-radius:var(--radius);background:var(--color-bg-card);color:var(--color-text);font-size:.9375rem}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--color-primary);box-shadow:0 0 0 3px #3b82f633}.scan-result[_ngcontent-%COMP%]{max-width:600px;margin:32px auto 0}@media(max-width:640px){.scan-result[_ngcontent-%COMP%]{margin-top:24px}}.scan-result__header[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;gap:16px}@media(max-width:640px){.scan-result__header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch;gap:12px}}.scan-result__header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;color:var(--color-text);margin:0;display:flex;align-items:center;gap:10px}.scan-result__header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]:before{content:"\\2713";display:inline-flex;align-items:center;justify-content:center;width:32px;height:32px;background:#10b981;color:#fff;border-radius:50%;font-size:1.25rem;font-weight:700}@media(max-width:640px){.scan-result__header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:1.25rem}.scan-result__header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]:before{width:28px;height:28px;font-size:1.125rem}}.scan-result__content[_ngcontent-%COMP%]{padding:20px;background:var(--color-bg-card);border-radius:var(--radius-lg);border:1px solid var(--color-border)}@media(max-width:640px){.scan-result__content[_ngcontent-%COMP%]{padding:16px}}.scan-result__code[_ngcontent-%COMP%]{font-family:Courier New,monospace;font-size:.9375rem;color:var(--color-text);word-break:break-all;margin:0 0 16px;padding:16px;background:var(--color-bg);border-radius:var(--radius);border:1px solid var(--color-border);line-height:1.6}@media(max-width:640px){.scan-result__code[_ngcontent-%COMP%]{font-size:.875rem;padding:12px}}.scan-result__success[_ngcontent-%COMP%]{color:#10b981;font-size:.9375rem;margin:0;font-weight:500;display:flex;align-items:center;gap:8px}.scan-result__success[_ngcontent-%COMP%]:before{content:"\\23f3";font-size:1.125rem}.scan-result__error[_ngcontent-%COMP%]{color:#ef4444;font-size:.9375rem;margin:0;font-weight:500;display:flex;align-items:center;gap:8px}.scan-result__error[_ngcontent-%COMP%]:before{content:"\\26a0\\fe0f";font-size:1.125rem}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;padding:10px 20px;border:none;border-radius:var(--radius);font-size:.9375rem;font-weight:500;cursor:pointer;transition:all .2s;text-decoration:none}.btn--primary[_ngcontent-%COMP%]{background:#3b82f6;color:#fff}.btn--primary[_ngcontent-%COMP%]:hover{background:#2563eb}.btn--secondary[_ngcontent-%COMP%]{background:var(--color-bg-card);color:var(--color-text);border:1px solid var(--color-border)}.btn--secondary[_ngcontent-%COMP%]:hover{filter:brightness(.95)}.btn--sm[_ngcontent-%COMP%]{padding:6px 12px;font-size:.875rem}.btn--icon[_ngcontent-%COMP%]{gap:8px}.btn-icon[_ngcontent-%COMP%]{font-size:1.125rem;line-height:1}.card[_ngcontent-%COMP%]{background:var(--color-bg-card);border:1px solid var(--color-border);border-radius:var(--radius-lg);padding:24px;box-shadow:0 1px 3px #00000014}@media(max-width:640px){.card[_ngcontent-%COMP%]{padding:16px}}']})}}return r})();export{Sn as QrScannerComponent};
