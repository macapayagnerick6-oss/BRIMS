import{a as S}from"./chunk-Z6OHWMWF.js";import"./chunk-6KDKIL6P.js";import{c as I,d as E}from"./chunk-DUWH3AKD.js";import{$a as t,Ea as p,Ia as y,Na as g,Rb as M,Vb as P,X as f,Y as x,Za as s,_a as n,ab as h,bb as v,cb as C,db as c,lb as i,mb as u,nb as d,ua as b,xa as r}from"./chunk-PQPYQFLK.js";function O(o,m){if(o&1){let e=v();n(0,"div",19),h(1,"img",20),n(2,"p",21),i(3,"Scan this QR code to quickly access your profile"),t(),n(4,"button",22),C("click",function(){f(e);let l=c(2);return x(l.downloadQRCode())}),i(5," Download QR Code "),t()()}if(o&2){let e=c(2);r(),s("src",e.qrCodeDataUrl,b)}}function q(o,m){if(o&1&&(n(0,"p",15)(1,"strong"),i(2,"Civil Status:"),t(),i(3),t()),o&2){let e=c(2);r(3),d(" ",e.resident.civilStatus)}}function R(o,m){if(o&1&&(n(0,"p",15)(1,"strong"),i(2,"Nationality:"),t(),i(3),t()),o&2){let e=c(2);r(3),d(" ",e.resident.nationality)}}function Q(o,m){if(o&1){let e=v();n(0,"div",2)(1,"h1",3),i(2,"My Profile"),t(),n(3,"div",4)(4,"div",5),h(5,"div",6),n(6,"div",7)(7,"p",8),i(8),t(),n(9,"div",9)(10,"button",10),C("click",function(){f(e);let l=c();return x(l.toggleQRCode())}),i(11),t(),g(12,O,6,1,"div",11),t(),n(13,"h2",12),i(14),t(),n(15,"div",13)(16,"h3",14),i(17,"Personal Information"),t(),n(18,"p",15)(19,"strong"),i(20,"Birthday:"),t(),i(21),t(),n(22,"p",15)(23,"strong"),i(24,"Place of Birth:"),t(),i(25),t(),n(26,"p",16)(27,"strong"),i(28,"Birth Certificate Number:"),t(),n(29,"span",17),i(30),t()(),n(31,"p",15)(32,"strong"),i(33,"Blood Type:"),t(),i(34),t(),n(35,"p",15)(36,"strong"),i(37,"Gender:"),t(),i(38),t(),g(39,q,4,1,"p",18)(40,R,4,1,"p",18),t(),n(41,"div",13)(42,"h3",14),i(43,"Contact Information"),t(),n(44,"p",15)(45,"strong"),i(46,"Contact:"),t(),i(47),t(),n(48,"p",15)(49,"strong"),i(50,"Email:"),t(),i(51),t(),n(52,"p",15)(53,"strong"),i(54,"Address:"),t(),i(55),t(),n(56,"p",15)(57,"strong"),i(58,"Purok:"),t(),i(59),t()()()()()()}if(o&2){let e=c();r(8),d("Resident ID: ",e.resident.residentId),r(3),d(" ",e.showQRCode?"Hide":"Show"," QR Code "),r(),s("ngIf",e.showQRCode&&e.qrCodeDataUrl),r(2),u(e.resident.name),r(7),d(" ",e.resident.birthdate||"N/A"),r(4),d(" ",e.resident.placeOfBirth||"Not Available"),r(5),u(e.resident.birthCertificateNumber||"Not Available"),r(4),d(" ",e.resident.bloodType||"Not Available"),r(4),d(" ",e.resident.gender),r(),s("ngIf",e.resident.civilStatus),r(),s("ngIf",e.resident.nationality),r(7),d(" ",e.resident.contact||"N/A"),r(4),d(" ",e.resident.email||"N/A"),r(4),d(" ",e.resident.address||"N/A"),r(4),d(" ",e.resident.purok)}}function k(o,m){o&1&&(n(0,"div",23)(1,"p",24),i(2,"Profile data not found."),t()())}var B=(()=>{class o{constructor(e,a,l){this.auth=e,this.data=a,this.qrCodeService=l,this.qrCodeDataUrl=null,this.showQRCode=!1,this.resident=null}resolveResident(){let e=this.auth.currentUser;if(!e||e.role!=="resident")return null;let a=e.id!=null?String(e.id):"",l=a?this.data.getResidentById(a):void 0;if(l)return l;let _=e.email?.trim().toLowerCase();return _?this.data.residents.find(w=>w.email?.trim().toLowerCase()===_)??null:null}ngOnInit(){this.resident=this.resolveResident(),this.sub=this.data.residentsObservable.subscribe(()=>{this.resident=this.resolveResident()})}ngOnDestroy(){this.sub?.unsubscribe()}generateQRCode(){if(this.resident?.residentId)try{this.qrCodeDataUrl=this.qrCodeService.generateResidentQRCode(this.resident.residentId)}catch(e){console.error("Error generating QR code:",e),this.qrCodeDataUrl=null}}toggleQRCode(){this.showQRCode=!this.showQRCode,this.showQRCode&&!this.qrCodeDataUrl&&this.resident?.residentId&&this.generateQRCode()}downloadQRCode(){if(!this.qrCodeDataUrl)return;let e=document.createElement("a");e.href=this.qrCodeDataUrl,e.download=`resident-${this.resident?.residentId||"qr"}-code.png`,document.body.appendChild(e),e.click(),document.body.removeChild(e)}static{this.\u0275fac=function(a){return new(a||o)(p(E),p(I),p(S))}}static{this.\u0275cmp=y({type:o,selectors:[["app-my-profile"]],decls:2,vars:2,consts:[["class","my-profile",4,"ngIf"],["class","card",4,"ngIf"],[1,"my-profile"],[1,"page-title"],[1,"profile-card","card"],[1,"profile-top"],[1,"avatar-lg"],[1,"profile-info"],[1,"resident-id"],[1,"qr-code-section"],["type","button",1,"btn","btn--sm","btn--outline",3,"click"],["class","qr-code-display",4,"ngIf"],[1,"resident-name"],[1,"detail-section"],[1,"section-title"],[1,"detail"],[1,"detail","highlight"],[1,"certificate-ref"],["class","detail",4,"ngIf"],[1,"qr-code-display"],["alt","My Resident QR Code",1,"qr-code-image",3,"src"],[1,"qr-code-label"],["type","button",1,"btn","btn--sm","btn--primary",3,"click"],[1,"card"],[1,"muted"]],template:function(a,l){a&1&&g(0,Q,60,15,"div",0)(1,k,3,0,"div",1),a&2&&(s("ngIf",l.resident),r(),s("ngIf",!l.resident))},dependencies:[P,M],styles:[".my-profile[_ngcontent-%COMP%]{width:100%}.page-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:600;margin:0 0 1.5rem}.profile-top[_ngcontent-%COMP%]{display:flex;gap:1.5rem;flex-wrap:wrap}.avatar-lg[_ngcontent-%COMP%]{width:80px;height:80px;border-radius:50%;background:var(--color-border);flex-shrink:0}.profile-info[_ngcontent-%COMP%]{flex:1;min-width:300px}.profile-info[_ngcontent-%COMP%]   .detail[_ngcontent-%COMP%]{margin:.75rem 0;font-size:.9375rem;line-height:1.5}.profile-info[_ngcontent-%COMP%]   .detail.highlight[_ngcontent-%COMP%]{background:var(--color-bg-secondary);color:var(--color-text);padding:.75rem 1rem;border-radius:6px;border-left:3px solid var(--color-primary);margin:1rem 0}.profile-info[_ngcontent-%COMP%]   .detail.highlight[_ngcontent-%COMP%]   .certificate-ref[_ngcontent-%COMP%]{font-family:Courier New,monospace;font-weight:600;color:var(--color-primary);font-size:1rem;letter-spacing:.5px}.qr-code-section[_ngcontent-%COMP%]{margin:1rem 0;padding:1rem 0;border-top:1px solid var(--color-border)}.qr-code-section[_ngcontent-%COMP%]   .qr-code-display[_ngcontent-%COMP%]{margin-top:1rem;display:flex;flex-direction:column;align-items:center;gap:.75rem;padding:1.5rem;background:var(--color-bg);border-radius:var(--radius-lg);border:1px solid var(--color-border)}.qr-code-section[_ngcontent-%COMP%]   .qr-code-display[_ngcontent-%COMP%]   .qr-code-image[_ngcontent-%COMP%]{width:200px;height:200px;border:4px solid var(--color-bg-card);border-radius:var(--radius);box-shadow:0 2px 8px #0000001a;background:var(--color-bg-card);padding:8px}.qr-code-section[_ngcontent-%COMP%]   .qr-code-display[_ngcontent-%COMP%]   .qr-code-label[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:var(--color-text-muted);text-align:center;max-width:300px}.detail-section[_ngcontent-%COMP%]{margin:1.5rem 0;padding-top:1rem;border-top:1px solid var(--color-border)}.detail-section[_ngcontent-%COMP%]:first-of-type{border-top:none;padding-top:0;margin-top:.5rem}.section-title[_ngcontent-%COMP%]{font-size:1rem;font-weight:600;color:var(--color-text);margin:0 0 .75rem;text-transform:uppercase;letter-spacing:.5px;font-size:.875rem}.muted[_ngcontent-%COMP%]{color:var(--color-text-muted)}"]})}}return o})();export{B as MyProfileComponent};
