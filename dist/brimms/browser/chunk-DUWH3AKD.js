import{$ as p,Cb as I,N as h,R as c,a as l,e as R,ha as E,j as g,m as a,n as m,q as S}from"./chunk-PQPYQFLK.js";var y="brims-theme",v=(()=>{class n{constructor(){this.themeSignal=E(this.getStoredOrSystemTheme()),this.theme=this.themeSignal.asReadonly(),this.isDark=I(()=>this.themeSignal()==="dark"),this.applyTheme(this.themeSignal())}getTheme(){return this.themeSignal()}setTheme(e){this.themeSignal.set(e),localStorage.setItem(y,e),this.applyTheme(e)}toggleTheme(){this.setTheme(this.themeSignal()==="dark"?"light":"dark")}getStoredOrSystemTheme(){if(typeof window>"u")return"light";let e=localStorage.getItem(y);return e==="dark"||e==="light"?e:"light"}applyTheme(e){typeof document>"u"||document.documentElement.setAttribute("data-theme",e)}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=h({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var i={RESIDENTS:"brims_residents",REQUESTS:"brims_requests",HOUSEHOLDS:"brims_households",USERS:"brims_users",ROLES:"brims_roles"},O=(()=>{class n{constructor(){this.initializeDefaultData()}initializeDefaultData(){if(!localStorage.getItem(i.RESIDENTS)){let e=[{id:"1",residentId:"BRGY-1001",name:"Juan Dela Cruz",age:44,gender:"Male",purok:"Purok 2",birthdate:"January 15, 1980",placeOfBirth:"Villanueva, Misamis Oriental",birthCertificateNumber:"BC-1980-001234",bloodType:"O+",civilStatus:"Single",nationality:"Filipino",contact:"0917 123 4557",address:"Purok 2, Barangay Name, City Name"},{id:"2",residentId:"BRGY-1002",name:"Maria Santos",age:38,gender:"Female",purok:"Purok 1",placeOfBirth:"Cagayan de Oro City",birthCertificateNumber:"BC-1986-005678",bloodType:"A+"},{id:"3",residentId:"BRGY-1003",name:"Pedro Reyes",age:65,gender:"Male",purok:"Purok 3",placeOfBirth:"Villanueva, Misamis Oriental",birthCertificateNumber:"BC-1959-009012",bloodType:"B+"},{id:"4",residentId:"BRGY-1004",name:"Ana Garcia",age:29,gender:"Female",purok:"Purok 2",placeOfBirth:"Villanueva, Misamis Oriental",birthCertificateNumber:"BC-1995-003456",bloodType:"AB+"},{id:"5",residentId:"BRGY-1005",name:"Roberto Lopez",age:72,gender:"Male",purok:"Purok 1",placeOfBirth:"Manila",birthCertificateNumber:"BC-1952-007890",bloodType:"O-"}];this.saveToStorage(i.RESIDENTS,e)}if(!localStorage.getItem(i.REQUESTS)){let e=[{id:"1",type:"Request Clearance",purpose:"For employment",status:"For Review",date:"Aug 15, 2034"},{id:"2",type:"Barangay Clearance",purpose:"For employment purposes",status:"Pending",date:"Apr 13, 2034"},{id:"3",type:"Certificate of Residency",purpose:"For school requirements",status:"Approved",date:"Mar 24, 2034"}];this.saveToStorage(i.REQUESTS,e)}if(!localStorage.getItem(i.HOUSEHOLDS)){let e=[{id:"h1",householdId:"HH-001",headId:"1",address:"Purok 2, Barangay Name, City Name",purok:"Purok 2",latitude:8.574,longitude:124.776,status:"Active",riskLevel:"flood_prone",barangayZone:"Zone 1",members:[{residentId:"BRGY-1001",name:"Juan Dela Cruz",age:44,gender:"Male",relationship:"Head",birthdate:"January 15, 1980",civilStatus:"Single"},{residentId:"BRGY-1004",name:"Ana Garcia",age:29,gender:"Female",relationship:"Sister",birthdate:"March 20, 1995",civilStatus:"Single"}]},{id:"h2",householdId:"HH-002",headId:"2",address:"Purok 1, Barangay Name, City Name",purok:"Purok 1",latitude:8.575,longitude:124.774,status:"Active",riskLevel:"fire_risk",barangayZone:"Zone 1",members:[{residentId:"BRGY-1002",name:"Maria Santos",age:38,gender:"Female",relationship:"Head",birthdate:"June 10, 1986",civilStatus:"Married"},{residentId:"BRGY-1005",name:"Roberto Lopez",age:72,gender:"Male",relationship:"Father",birthdate:"May 5, 1952",civilStatus:"Widowed"}]},{id:"h3",householdId:"HH-003",headId:"3",address:"Purok 3, Barangay Name, City Name",purok:"Purok 3",latitude:8.573,longitude:124.778,status:"Active",riskLevel:"normal",barangayZone:"Zone 2",members:[{residentId:"BRGY-1003",name:"Pedro Reyes",age:65,gender:"Male",relationship:"Head",birthdate:"August 22, 1959",civilStatus:"Married"}]}];this.saveToStorage(i.HOUSEHOLDS,e)}if(!localStorage.getItem(i.USERS)){let e=[{id:"1",name:"Staff User",email:"staff@barangay.gov",role:"Staff",status:"Active",lastLogin:"Jan 29, 2026",createdAt:"Jan 1, 2025"},{id:"2",name:"Juan Dela Cruz",email:"resident@email.com",role:"Resident",status:"Active",lastLogin:"Jan 28, 2026",createdAt:"Jan 15, 2025"},{id:"3",name:"Maria Santos",email:"maria.santos@email.com",role:"Resident",status:"Active",lastLogin:"Jan 27, 2026",createdAt:"Feb 3, 2025"},{id:"4",name:"Admin User",email:"admin@barangay.gov",role:"Admin",status:"Active",lastLogin:"Jan 29, 2026",createdAt:"Dec 1, 2024"},{id:"5",name:"Pedro Reyes",email:"pedro.reyes@email.com",role:"Resident",status:"Inactive",lastLogin:"Dec 15, 2025",createdAt:"Mar 10, 2025"},{id:"6",name:"Ana Garcia",email:"ana.garcia@email.com",role:"Resident",status:"Active",lastLogin:"Jan 26, 2026",createdAt:"Apr 5, 2025"},{id:"7",name:"Roberto Lopez",email:"roberto.lopez@email.com",role:"Resident",status:"Active",lastLogin:"Jan 25, 2026",createdAt:"May 12, 2025"}];this.saveToStorage(i.USERS,e)}if(!localStorage.getItem(i.ROLES)){let e=[{id:"1",name:"Admin",description:"Full system access with all permissions",permissions:["Manage Users","Manage Roles","View All Reports","Manage Residents","Manage Households","Approve Requests","System Settings"],userCount:1},{id:"2",name:"Staff",description:"Barangay staff with management capabilities",permissions:["View Reports","Manage Residents","Manage Households","Process Requests","View Users"],userCount:1},{id:"3",name:"Resident",description:"Regular resident users with limited access",permissions:["View Own Profile","Request Certificates","View Own Requests","Update Profile"],userCount:5}];this.saveToStorage(i.ROLES,e)}}getFromStorage(e){try{let t=localStorage.getItem(e);return t?JSON.parse(t):[]}catch(t){return console.error(`Error reading from localStorage (${e}):`,t),[]}}saveToStorage(e,t){try{localStorage.setItem(e,JSON.stringify(t))}catch(s){throw console.error(`Error saving to localStorage (${e}):`,s),s}}getResidents(){return a(this.getFromStorage(i.RESIDENTS))}getResidentById(e){let s=this.getFromStorage(i.RESIDENTS).find(r=>r.id===e);return a(s||null)}getResidentByResidentId(e){let s=this.getFromStorage(i.RESIDENTS).find(r=>r.residentId===e);return a(s||null)}addResident(e){let t=this.getFromStorage(i.RESIDENTS);return t.push(e),this.saveToStorage(i.RESIDENTS,t),a(e)}updateResident(e,t){let s=this.getFromStorage(i.RESIDENTS),r=s.findIndex(o=>o.id===e);return r===-1?m(()=>new Error(`Resident with id ${e} not found`)):(s[r]=l(l({},s[r]),t),this.saveToStorage(i.RESIDENTS,s),a(s[r]))}deleteResident(e){let s=this.getFromStorage(i.RESIDENTS).filter(r=>r.id!==e);return this.saveToStorage(i.RESIDENTS,s),a(void 0)}getRequests(){return a(this.getFromStorage(i.REQUESTS))}getRequestById(e){let s=this.getFromStorage(i.REQUESTS).find(r=>r.id===e);return a(s||null)}addRequest(e){let t=this.getFromStorage(i.REQUESTS);return t.push(e),this.saveToStorage(i.REQUESTS,t),a(e)}updateRequest(e,t){let s=this.getFromStorage(i.REQUESTS),r=s.findIndex(o=>o.id===e);return r===-1?m(()=>new Error(`Request with id ${e} not found`)):(s[r]=l(l({},s[r]),t),this.saveToStorage(i.REQUESTS,s),a(s[r]))}deleteRequest(e){let s=this.getFromStorage(i.REQUESTS).filter(r=>r.id!==e);return this.saveToStorage(i.REQUESTS,s),a(void 0)}getHouseholds(){return a(this.getFromStorage(i.HOUSEHOLDS))}getHouseholdById(e){let s=this.getFromStorage(i.HOUSEHOLDS).find(r=>r.id===e);return a(s||null)}getHouseholdByResidentId(e){let s=this.getFromStorage(i.HOUSEHOLDS).find(r=>r.members.some(o=>o.residentId===e));return a(s||null)}getHouseholdByHeadId(e){let s=this.getFromStorage(i.HOUSEHOLDS).find(r=>r.headId===e);return a(s||null)}addHousehold(e){let t=this.getFromStorage(i.HOUSEHOLDS);return t.push(e),this.saveToStorage(i.HOUSEHOLDS,t),a(e)}updateHousehold(e,t){let s=this.getFromStorage(i.HOUSEHOLDS),r=s.findIndex(o=>o.id===e);return r===-1?m(()=>new Error(`Household with id ${e} not found`)):(s[r]=l(l({},s[r]),t),this.saveToStorage(i.HOUSEHOLDS,s),a(s[r]))}deleteHousehold(e){let s=this.getFromStorage(i.HOUSEHOLDS).filter(r=>r.id!==e);return this.saveToStorage(i.HOUSEHOLDS,s),a(void 0)}getUsers(){return a(this.getFromStorage(i.USERS))}getUserById(e){let s=this.getFromStorage(i.USERS).find(r=>r.id===e);return a(s||null)}addUser(e){let t=this.getFromStorage(i.USERS);return t.push(e),this.saveToStorage(i.USERS,t),a(e)}updateUser(e,t){let s=this.getFromStorage(i.USERS),r=s.findIndex(o=>o.id===e);return r===-1?m(()=>new Error(`User with id ${e} not found`)):(s[r]=l(l({},s[r]),t),this.saveToStorage(i.USERS,s),a(s[r]))}deleteUser(e){let s=this.getFromStorage(i.USERS).filter(r=>r.id!==e);return this.saveToStorage(i.USERS,s),a(void 0)}getRoles(){return a(this.getFromStorage(i.ROLES))}getRoleById(e){let s=this.getFromStorage(i.ROLES).find(r=>r.id===e);return a(s||null)}addRole(e){let t=this.getFromStorage(i.ROLES);return t.push(e),this.saveToStorage(i.ROLES,t),a(e)}updateRole(e,t){let s=this.getFromStorage(i.ROLES),r=s.findIndex(o=>o.id===e);return r===-1?m(()=>new Error(`Role with id ${e} not found`)):(s[r]=l(l({},s[r]),t),this.saveToStorage(i.ROLES,s),a(s[r]))}deleteRole(e){let s=this.getFromStorage(i.ROLES).filter(r=>r.id!==e);return this.saveToStorage(i.ROLES,s),a(void 0)}getStats(){let e=this.getFromStorage(i.RESIDENTS),t=this.getFromStorage(i.HOUSEHOLDS),s=e.filter(r=>r.age>=60).length;return a({totalResidents:e.length,totalHouseholds:t.length,seniorCitizens:s||245})}static{this.\u0275fac=function(t){return new(t||n)}}static{this.\u0275prov=h({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var x=(()=>{class n{constructor(e,t){this.database=e,this.audit=t,this.residents=[],this.requests=[],this.households=[],this.users=[],this.roles=[],this.residents$=new g([]),this.requests$=new g([]),this.households$=new g([]),this.users$=new g([]),this.roles$=new g([]),this.initializeData()}initializeData(){return R(this,null,function*(){try{this.residents=yield S(this.database.getResidents()),this.requests=yield S(this.database.getRequests()),this.households=yield S(this.database.getHouseholds()),this.users=yield S(this.database.getUsers()),this.roles=yield S(this.database.getRoles()),this.residents$.next(this.residents),this.requests$.next(this.requests),this.households$.next(this.households),this.users$.next(this.users),this.roles$.next(this.roles),this.database.getResidents().subscribe(e=>{this.residents=e,this.residents$.next(e)}),this.database.getRequests().subscribe(e=>{this.requests=e,this.requests$.next(e)}),this.database.getHouseholds().subscribe(e=>{this.households=e,this.households$.next(e)}),this.database.getUsers().subscribe(e=>{this.users=e,this.users$.next(e)}),this.database.getRoles().subscribe(e=>{this.roles=e,this.roles$.next(e)})}catch(e){console.error("Error initializing data:",e)}})}getResidentById(e){if(e==null)return;let t=String(e);return this.residents.find(s=>String(s.id)===t)}getResidentByResidentId(e){return this.residents.find(t=>t.residentId===e)}addResident(e){this.residents.push(e),this.audit.log({action:"Add resident",category:"resident",details:`Added resident: ${e.name} (${e.residentId})`,entityId:e.id,entityName:e.name}),this.residents$.next(this.residents),this.database.addResident(e).subscribe({next:()=>{this.database.getResidents().subscribe(t=>{this.residents=t,this.residents$.next(t)})},error:t=>{console.error("Error adding resident:",t);let s=this.residents.findIndex(r=>r.id===e.id);s!==-1&&(this.residents.splice(s,1),this.residents$.next(this.residents))}})}updateResident(e,t){let s=this.residents.find(r=>r.id===e);s&&(this.audit.log({action:"Update resident",category:"resident",details:`Updated resident: ${s.name} (${s.residentId})`,entityId:e,entityName:s.name}),Object.assign(s,t),this.residents$.next(this.residents),t.name!==void 0&&this.households.forEach(r=>{let o=r.members.find(u=>u.residentId===s.residentId);o&&(o.name=t.name,this.database.updateHousehold(r.id,{members:r.members}).subscribe())}),this.database.updateResident(e,t).subscribe({next:()=>{this.database.getResidents().subscribe(r=>{this.residents=r,this.residents$.next(r)})},error:r=>{console.error("Error updating resident:",r)}}))}getRequestById(e){return this.requests.find(t=>t.id===e)}getRequestsByResidentId(e){return this.requests.filter(t=>t.residentId===e)}addRequest(e){this.requests.push(e),this.audit.log({action:"Add certificate request",category:"request",details:`${e.type} - ${e.purpose}`,entityId:e.id}),this.requests$.next(this.requests),this.database.addRequest(e).subscribe({next:()=>{this.database.getRequests().subscribe(t=>{this.requests=t,this.requests$.next(t)})},error:t=>{console.error("Error adding request:",t);let s=this.requests.findIndex(r=>r.id===e.id);s!==-1&&(this.requests.splice(s,1),this.requests$.next(this.requests))}})}updateRequest(e,t){let s=this.requests.find(r=>r.id===e);s&&(t.status&&this.audit.log({action:"Update request status",category:"request",details:`Request ${e}: ${s.status} \u2192 ${t.status}`,entityId:e}),Object.assign(s,t),this.requests$.next(this.requests),this.database.updateRequest(e,t).subscribe({next:()=>{this.database.getRequests().subscribe(r=>{this.requests=r,this.requests$.next(r)})},error:r=>{console.error("Error updating request:",r)}}))}getHouseholdByResidentId(e){return this.households.find(t=>t.members.some(s=>s.residentId===e))}getHouseholdByHeadId(e){return this.households.find(t=>t.headId===e)}getHouseholdById(e){return this.households.find(t=>t.id===e)}addHousehold(e){this.households.push(e),this.audit.log({action:"Add household",category:"household",details:`Added household ${e.householdId} (${e.address})`,entityId:e.id,entityName:e.householdId}),this.households$.next(this.households),this.database.addHousehold(e).subscribe({next:()=>{this.database.getHouseholds().subscribe(t=>{this.households=t,this.households$.next(t)})},error:t=>{console.error("Error adding household:",t);let s=this.households.findIndex(r=>r.id===e.id);s!==-1&&(this.households.splice(s,1),this.households$.next(this.households))}})}updateHousehold(e,t){let s=this.households.find(r=>r.id===e);s&&(this.audit.log({action:"Update household",category:"household",details:`Updated household ${s.householdId}`,entityId:e,entityName:s.householdId}),Object.assign(s,t),this.households$.next(this.households),this.database.updateHousehold(e,t).subscribe({next:()=>{this.database.getHouseholds().subscribe(r=>{this.households=r,this.households$.next(r)})},error:r=>{console.error("Error updating household:",r)}}))}getStats(){let e=this.residents.filter(t=>t.age>=60).length;return{totalResidents:this.residents.length,totalHouseholds:this.households.length,seniorCitizens:e||245}}getUsersByRole(e){return this.users.filter(t=>t.role.toLowerCase()===e.toLowerCase())}addUser(e){this.users.push(e),this.audit.log({action:"Add user",category:"user",details:`Added user: ${e.name} (${e.email}) - ${e.role}`,entityId:e.id,entityName:e.name}),this.users$.next(this.users);let t=this.roles.find(s=>s.name===e.role);t&&(t.userCount++,this.roles$.next(this.roles)),this.database.addUser(e).subscribe({next:()=>{t&&this.database.updateRole(t.id,{userCount:t.userCount}).subscribe(),this.database.getUsers().subscribe(s=>{this.users=s,this.users$.next(s)}),this.database.getRoles().subscribe(s=>{this.roles=s,this.roles$.next(s)})},error:s=>{console.error("Error adding user:",s);let r=this.users.findIndex(o=>o.id===e.id);r!==-1&&(this.users.splice(r,1),this.users$.next(this.users),t&&(t.userCount--,this.roles$.next(this.roles)))}})}updateUserRole(e,t){let s=this.users.find(u=>u.id===e);if(!s)return;this.audit.log({action:"Update user role",category:"user",details:`${s.name}: ${s.role} \u2192 ${t}`,entityId:e,entityName:s.name});let r=this.roles.find(u=>u.name===s.role),o=this.roles.find(u=>u.name===t);r&&r.userCount--,o&&o.userCount++,s.role=t,this.users$.next(this.users),this.roles$.next(this.roles),this.database.updateUser(e,{role:t}).subscribe({next:()=>{r&&this.database.updateRole(r.id,{userCount:r.userCount}).subscribe(),o&&this.database.updateRole(o.id,{userCount:o.userCount}).subscribe(),this.database.getUsers().subscribe(u=>{this.users=u,this.users$.next(u)}),this.database.getRoles().subscribe(u=>{this.roles=u,this.roles$.next(u)})},error:u=>{console.error("Error updating user role:",u),r&&r.userCount++,o&&o.userCount--,s.role=r?.name||s.role,this.users$.next(this.users),this.roles$.next(this.roles)}})}get residentsObservable(){return this.residents$.asObservable()}get requestsObservable(){return this.requests$.asObservable()}get householdsObservable(){return this.households$.asObservable()}get usersObservable(){return this.users$.asObservable()}get rolesObservable(){return this.roles$.asObservable()}updateRole(e,t){let s=this.roles.find(o=>o.id===e);if(!s)return;let r=l({},s);this.audit.log({action:"Update role",category:"role",details:`Updated role: ${s.name}`,entityId:e,entityName:s.name}),Object.assign(s,t),this.roles$.next(this.roles),this.database.updateRole(e,t).subscribe({next:()=>{this.database.getRoles().subscribe(o=>{this.roles=o,this.roles$.next(o)})},error:o=>{console.error("Error updating role:",o);let u=this.roles.findIndex(d=>d.id===e);u!==-1&&(this.roles[u]=r,this.roles$.next(this.roles))}})}static{this.\u0275fac=function(t){return new(t||n)(c(O),c(b))}}static{this.\u0275prov=h({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var T=(()=>{class n{constructor(e,t,s){this.theme=e,this.data=t,this.audit=s,this.STORAGE_KEY="brimms_user"}login(e,t){let s=e?.trim().toLowerCase()??"",r=t??"",o=this.data.residents.find(d=>d.email?.trim().toLowerCase()===s);if(o?.password===r){let d={id:o.id,name:o.name,email:o.email??s,role:"resident"};return sessionStorage.setItem(this.STORAGE_KEY,JSON.stringify(d)),this.audit.log({action:"Login",category:"auth",userId:d.id,userName:d.name,userEmail:d.email,details:"Resident logged in"}),{success:!0,role:"resident"}}let u=this.data.users.find(d=>d.email?.trim().toLowerCase()===s&&(d.role==="Staff"||d.role==="Admin")&&d.status==="Active");if(u&&u.password===r){let d={id:u.id,name:u.name,email:u.email,role:"staff"};return sessionStorage.setItem(this.STORAGE_KEY,JSON.stringify(d)),this.audit.log({action:"Login",category:"auth",userId:d.id,userName:d.name,userEmail:d.email,details:"Staff/Admin logged in"}),{success:!0,role:"staff"}}if(s==="staff@barangay.gov"&&r){let d={id:"1",name:"Staff User",email:s,role:"staff"};return sessionStorage.setItem(this.STORAGE_KEY,JSON.stringify(d)),this.audit.log({action:"Login",category:"auth",userId:d.id,userName:d.name,userEmail:d.email,details:"Demo staff logged in"}),{success:!0,role:"staff"}}if(s==="resident@email.com"&&r){let d={id:"1",name:"Juan Dela Cruz",email:s,role:"resident"};return sessionStorage.setItem(this.STORAGE_KEY,JSON.stringify(d)),this.audit.log({action:"Login",category:"auth",userId:d.id,userName:d.name,userEmail:d.email,details:"Demo resident logged in"}),{success:!0,role:"resident"}}return{success:!1}}logout(){let e=this.currentUser;e&&this.audit.log({action:"Logout",category:"auth",userId:e.id,userName:e.name,userEmail:e.email,details:"User logged out"}),sessionStorage.removeItem(this.STORAGE_KEY),this.theme.setTheme("light")}get currentUser(){let e=sessionStorage.getItem(this.STORAGE_KEY);return e?JSON.parse(e):null}get isLoggedIn(){return!!this.currentUser}forgotPassword(e){if(!["staff@barangay.gov","resident@email.com"].includes(e))return{success:!1,message:"Email not found in our system."};let s=this.generateResetToken(),r={email:e,token:s,expiresAt:Date.now()+36e5};return sessionStorage.setItem(`reset_token_${e}`,JSON.stringify(r)),console.log(`Reset link for ${e}: /reset-password?token=${s}&email=${encodeURIComponent(e)}`),{success:!0}}resetPassword(e,t,s){let r=sessionStorage.getItem(`reset_token_${t}`);if(!r)return{success:!1,message:"Invalid or expired reset token."};let o=JSON.parse(r);return o.token!==e?{success:!1,message:"Invalid reset token."}:Date.now()>o.expiresAt?(sessionStorage.removeItem(`reset_token_${t}`),{success:!1,message:"Reset token has expired. Please request a new one."}):(sessionStorage.removeItem(`reset_token_${t}`),console.log(`Password reset for ${t} completed successfully.`),{success:!0})}generateResetToken(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}static{this.\u0275fac=function(t){return new(t||n)(c(v),c(x),c(b))}}static{this.\u0275prov=h({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var U="brims_audit_log",q=2e3,b=(()=>{class n{constructor(e){this.injector=e,this.logs$=new g([]),this.loadFromStorage()}loadFromStorage(){try{let e=localStorage.getItem(U),t=e?JSON.parse(e):[];this.logs$.next(t)}catch(e){this.logs$.next([])}}saveToStorage(e){try{let t=e.slice(-q);localStorage.setItem(U,JSON.stringify(t)),this.logs$.next(t)}catch(t){console.error("Error saving audit log:",t)}}getLogs(){return[...this.logs$.value].reverse()}getLogsObservable(){return this.logs$.asObservable()}log(e){let t=this.injector.get(T).currentUser,s={id:`audit_${Date.now()}_${Math.random().toString(36).slice(2,9)}`,timestamp:new Date().toISOString(),action:e.action,category:e.category,userId:e.userId??t?.id,userName:e.userName??t?.name,userEmail:e.userEmail??t?.email,details:e.details,entityId:e.entityId,entityName:e.entityName},r=this.logs$.value;r.push(s),this.saveToStorage(r)}static{this.\u0275fac=function(t){return new(t||n)(c(p))}}static{this.\u0275prov=h({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();export{v as a,b,x as c,T as d};
