import{a as Q}from"./chunk-Z6OHWMWF.js";import"./chunk-6KDKIL6P.js";import{c as y,f as E}from"./chunk-BRLNKSN4.js";import"./chunk-KPGMZ2XY.js";import{c as D}from"./chunk-DUWH3AKD.js";import{$a as t,Ea as p,Ia as b,Pb as S,Ta as l,Ua as u,Vb as k,X as m,Y as g,Za as M,_a as n,a as x,ab as v,b as h,bb as q,cb as _,db as c,lb as i,mb as C,nb as f,ob as R,ua as O,wb as w,xa as r}from"./chunk-PQPYQFLK.js";var I=(o,d)=>({"badge--success":o,"badge--warning":d});function U(o,d){if(o&1&&i(0),o&2){let e=c(2);R(" ",e.requester.name," (",e.requester.residentId,") ")}}function T(o,d){o&1&&(n(0,"span",13),i(1,"Not linked to a resident"),t())}function V(o,d){if(o&1&&i(0),o&2){let e=c(2);f(" ",e.requester.address||"Purok "+e.requester.purok," ")}}function j(o,d){o&1&&(n(0,"span",13),i(1,"N/A"),t())}function z(o,d){if(o&1){let e=q();n(0,"div",17),v(1,"img",20),n(2,"p",21),i(3,"Scan this QR code to quickly access this request"),t(),n(4,"button",22),_("click",function(){m(e);let s=c(2);return g(s.downloadQRCode())}),i(5," Download QR Code "),t()()}if(o&2){let e=c(2);r(),M("src",e.qrCodeDataUrl,O)}}function A(o,d){if(o&1){let e=q();n(0,"div",19)(1,"h2"),i(2,"Actions"),t(),n(3,"div",23)(4,"button",24),_("click",function(){m(e);let s=c(2);return g(s.approveRequest())}),i(5,"Approve"),t(),n(6,"button",25),_("click",function(){m(e);let s=c(2);return g(s.rejectRequest())}),i(7,"Reject"),t()()()}}function B(o,d){if(o&1){let e=q();n(0,"div",1)(1,"div",2)(2,"h1",3),i(3,"Request Details"),t(),n(4,"a",4)(5,"span",5),i(6,"\u2190"),t(),n(7,"span",6),i(8,"Back to Requests"),t()()(),n(9,"div",7)(10,"div",8)(11,"h2"),i(12,"Request Information"),t(),n(13,"div",9)(14,"div",10)(15,"span",11),i(16,"Request ID:"),t(),n(17,"span",12),i(18),t()(),n(19,"div",10)(20,"span",11),i(21,"Requested By:"),t(),n(22,"span",12),l(23,U,1,2)(24,T,2,0,"span",13),t()(),n(25,"div",10)(26,"span",11),i(27,"Address / Purok:"),t(),n(28,"span",12),l(29,V,1,1)(30,j,2,0,"span",13),t()(),n(31,"div",14)(32,"span",11),i(33,"QR Code:"),t(),n(34,"div",15)(35,"button",16),_("click",function(){m(e);let s=c();return g(s.toggleQRCode())}),i(36),t(),l(37,z,6,1,"div",17),t()(),n(38,"div",10)(39,"span",11),i(40,"Type:"),t(),n(41,"span",12),i(42),t()(),n(43,"div",10)(44,"span",11),i(45,"Purpose:"),t(),n(46,"span",12),i(47),t()(),n(48,"div",10)(49,"span",11),i(50,"Status:"),t(),n(51,"span",12)(52,"span",18),i(53),t()()(),n(54,"div",10)(55,"span",11),i(56,"Date:"),t(),n(57,"span",12),i(58),t()()()(),l(59,A,8,0,"div",19),t()()}if(o&2){let e=c();r(18),C(e.request.id),r(5),u(e.requester?23:24),r(6),u(e.requester?29:30),r(7),f(" ",e.showQRCode?"Hide":"Show"," QR Code "),r(),u(e.showQRCode&&e.qrCodeDataUrl?37:-1),r(5),C(e.request.type),r(5),C(e.request.purpose),r(5),M("ngClass",w(11,I,e.request.status==="Approved",e.request.status==="Pending"||e.request.status==="For Review")),r(),f(" ",e.request.status," "),r(5),C(e.request.date),r(),u(e.request.status==="Pending"||e.request.status==="For Review"?59:-1)}}function F(o,d){o&1&&(n(0,"div",1)(1,"h1",3),i(2,"Request Not Found"),t(),n(3,"p",13),i(4,"The request you're looking for doesn't exist."),t(),n(5,"a",4)(6,"span",5),i(7,"\u2190"),t(),n(8,"span",6),i(9,"Back to Requests"),t()()())}var W=(()=>{class o{constructor(e,a,s){this.route=e,this.data=a,this.qrCodeService=s,this.qrCodeDataUrl=null,this.showQRCode=!1,this.isUpdating=!1;let P=this.route.snapshot.paramMap.get("id");P&&(this.request=this.data.getRequestById(P),this.request&&this.loadRequester())}ngOnInit(){this.route.paramMap.subscribe(e=>{let a=e.get("id");a?(this.request=this.data.getRequestById(a),this.request?(this.loadRequester(),this.generateQRCode()):this.requester=void 0):(this.request=void 0,this.requester=void 0,this.qrCodeDataUrl=null)})}generateQRCode(){if(this.request?.id)try{this.qrCodeDataUrl=this.qrCodeService.generateRequestQRCode(this.request.id)}catch(e){console.error("Error generating QR code:",e),this.qrCodeDataUrl=null}}toggleQRCode(){this.showQRCode=!this.showQRCode,this.showQRCode&&!this.qrCodeDataUrl&&this.request?.id&&this.generateQRCode()}downloadQRCode(){if(!this.qrCodeDataUrl)return;let e=document.createElement("a");e.href=this.qrCodeDataUrl,e.download=`request-${this.request?.id||"qr"}-code.png`,document.body.appendChild(e),e.click(),document.body.removeChild(e)}loadRequester(){this.request?.residentId?this.requester=this.data.getResidentByResidentId(this.request.residentId):this.requester=void 0}approveRequest(){if(!this.request||this.isUpdating)return;this.isUpdating=!0;let e=this.request.id;this.data.updateRequest(e,{status:"Approved"}),this.request=h(x({},this.request),{status:"Approved"}),this.isUpdating=!1}rejectRequest(){if(!this.request||this.isUpdating)return;this.isUpdating=!0;let e=this.request.id;this.data.updateRequest(e,{status:"Rejected"}),this.request=h(x({},this.request),{status:"Rejected"}),this.isUpdating=!1}static{this.\u0275fac=function(a){return new(a||o)(p(y),p(D),p(Q))}}static{this.\u0275cmp=b({type:o,selectors:[["app-request-detail"]],decls:3,vars:1,consts:[[1,"request-detail"],[1,"card"],[1,"request-header"],[1,"page-title"],["routerLink","/staff/requests",1,"back-button"],[1,"back-button__icon"],[1,"back-button__text"],[1,"request-info"],[1,"info-section"],[1,"info-grid"],[1,"info-item"],[1,"info-label"],[1,"info-value"],[1,"muted"],[1,"info-item","qr-code-item"],[1,"qr-code-controls"],["type","button",1,"btn","btn--sm","btn--outline",3,"click"],[1,"qr-code-display"],[1,"badge",3,"ngClass"],[1,"action-section"],["alt","Request QR Code",1,"qr-code-image",3,"src"],[1,"qr-code-label"],["type","button",1,"btn","btn--sm","btn--primary",3,"click"],[1,"action-buttons"],["type","button",1,"btn","btn--success",3,"click"],["type","button",1,"btn","btn--danger",3,"click"]],template:function(a,s){a&1&&(n(0,"div",0),l(1,B,60,14,"div",1)(2,F,10,0,"div",1),t()),a&2&&(r(),u(s.request?1:2))},dependencies:[k,S,E],styles:[".request-detail[_ngcontent-%COMP%]   .request-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:2rem;gap:1rem}.request-detail[_ngcontent-%COMP%]   .request-header[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{margin-bottom:0}@media(max-width:640px){.request-detail[_ngcontent-%COMP%]   .request-header[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.request-detail[_ngcontent-%COMP%]   .request-header[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{margin-bottom:1rem}}.request-detail[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.625rem 1.25rem;color:var(--color-text);text-decoration:none;font-weight:500;font-size:.9375rem;border-radius:var(--radius);transition:all .2s ease;width:fit-content;background:var(--color-bg);border:1px solid var(--color-border);white-space:nowrap}.request-detail[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]:hover{background:var(--color-bg-card);border-color:var(--color-primary);color:var(--color-primary);transform:translate(-2px);box-shadow:var(--shadow)}.request-detail[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]:active{transform:translate(-1px)}.request-detail[_ngcontent-%COMP%]   .back-button__icon[_ngcontent-%COMP%]{font-size:1.125rem;line-height:1;transition:transform .2s ease}.request-detail[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]:hover   .request-detail[_ngcontent-%COMP%]   .back-button__icon[_ngcontent-%COMP%]{transform:translate(-2px)}.request-detail[_ngcontent-%COMP%]   .back-button__text[_ngcontent-%COMP%]{line-height:1.5}@media(max-width:640px){.request-detail[_ngcontent-%COMP%]   .back-button[_ngcontent-%COMP%]{width:100%;justify-content:center}}.request-detail[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]{margin-bottom:2rem}.request-detail[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:1rem;color:var(--color-text);font-size:1.25rem}.request-detail[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1rem}.request-detail[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.request-detail[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-label[_ngcontent-%COMP%]{font-weight:600;color:var(--color-text-muted);font-size:.875rem}.request-detail[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item[_ngcontent-%COMP%]   .info-value[_ngcontent-%COMP%]{color:var(--color-text);font-size:1rem}.request-detail[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item.qr-code-item[_ngcontent-%COMP%]{grid-column:1/-1}.request-detail[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item.qr-code-item[_ngcontent-%COMP%]   .qr-code-controls[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.request-detail[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item.qr-code-item[_ngcontent-%COMP%]   .qr-code-controls[_ngcontent-%COMP%]   .qr-code-display[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.75rem;padding:1.5rem;background:var(--color-bg);border-radius:var(--radius-lg);border:1px solid var(--color-border)}.request-detail[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item.qr-code-item[_ngcontent-%COMP%]   .qr-code-controls[_ngcontent-%COMP%]   .qr-code-display[_ngcontent-%COMP%]   .qr-code-image[_ngcontent-%COMP%]{width:200px;height:200px;border:4px solid var(--color-bg-card);border-radius:var(--radius);box-shadow:0 2px 8px #0000001a;background:var(--color-bg-card);padding:8px}.request-detail[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]   .info-section[_ngcontent-%COMP%]   .info-grid[_ngcontent-%COMP%]   .info-item.qr-code-item[_ngcontent-%COMP%]   .qr-code-controls[_ngcontent-%COMP%]   .qr-code-display[_ngcontent-%COMP%]   .qr-code-label[_ngcontent-%COMP%]{margin:0;font-size:.875rem;color:var(--color-text-muted);text-align:center;max-width:300px}.request-detail[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]   .action-section[_ngcontent-%COMP%]{margin-top:2rem;padding-top:2rem;border-top:1px solid var(--color-border)}.request-detail[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]   .action-section[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin-bottom:1rem;color:var(--color-text);font-size:1.25rem}.request-detail[_ngcontent-%COMP%]   .request-info[_ngcontent-%COMP%]   .action-section[_ngcontent-%COMP%]   .action-buttons[_ngcontent-%COMP%]{display:flex;gap:1rem}"]})}}return o})();export{W as RequestDetailComponent};
