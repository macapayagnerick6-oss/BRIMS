import{a as Q}from"./chunk-6RFJ52Y7.js";import{a as F,b as $}from"./chunk-SNJKFSQO.js";import{a as U,b as W,d as j,e as g,h as z}from"./chunk-BRLNKSN4.js";import{b as B}from"./chunk-KPGMZ2XY.js";import{d as w}from"./chunk-DUWH3AKD.js";import{$a as r,Ab as G,Ea as A,Fb as H,Ia as P,La as M,Pb as I,S as m,Sa as b,Ta as h,Tb as L,Ua as u,X as f,Xa as T,Y as _,Ya as N,Za as O,_a as a,ab as q,bb as x,cb as C,db as l,lb as p,mb as E,nb as v,xa as s,xb as D,yb as R,zb as V}from"./chunk-PQPYQFLK.js";var k=()=>{let t=m(w),n=m(g);return t.isLoggedIn?!0:(n.navigate(["/login"]),!1)};var S=()=>{let t=m(w),n=m(g),o=t.currentUser,e=c=>{if(c)return c.data&&c.data.role?c.data.role:e(c.parent)},i=n.routerState.snapshot.root,d=e(i.firstChild);if(!d||o?.role===d)return!0;let y=o?.role==="staff"?"/staff":"/resident";return n.navigate([y]),!1};var Y=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",loadComponent:()=>import("./chunk-ZBCDMFAH.js").then(t=>t.LoginComponent)},{path:"forgot-password",loadComponent:()=>import("./chunk-73OEML2M.js").then(t=>t.ForgotPasswordComponent)},{path:"reset-password",loadComponent:()=>import("./chunk-HA6QTEMH.js").then(t=>t.ResetPasswordComponent)},{path:"staff",canActivate:[k,S],data:{role:"staff"},loadComponent:()=>import("./chunk-XC25Q4RC.js").then(t=>t.StaffLayoutComponent),children:[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",loadComponent:()=>import("./chunk-JSGYQMS7.js").then(t=>t.StaffDashboardComponent)},{path:"residents",loadComponent:()=>import("./chunk-6ODTZ5YZ.js").then(t=>t.ResidentsListComponent)},{path:"residents/add",loadComponent:()=>import("./chunk-7VBLQVPR.js").then(t=>t.AddResidentComponent)},{path:"residents/:id",loadComponent:()=>import("./chunk-BWAGEFNK.js").then(t=>t.ResidentProfileComponent)},{path:"households",loadComponent:()=>import("./chunk-YJPPCI7A.js").then(t=>t.HouseholdsComponent)},{path:"households/map",loadComponent:()=>import("./chunk-V4J7Z5HT.js").then(t=>t.HouseholdMapComponent)},{path:"households/add",loadComponent:()=>import("./chunk-SGXGY46M.js").then(t=>t.AddHouseholdComponent)},{path:"households/:id/edit",loadComponent:()=>import("./chunk-25MATR27.js").then(t=>t.EditHouseholdComponent)},{path:"households/:id",loadComponent:()=>import("./chunk-I5U4EOF7.js").then(t=>t.HouseholdDetailComponent)},{path:"reports",loadComponent:()=>import("./chunk-ZDR6NKMX.js").then(t=>t.ReportsComponent)},{path:"requests/:id",loadComponent:()=>import("./chunk-MZ3BPVWK.js").then(t=>t.RequestDetailComponent)},{path:"requests",loadComponent:()=>import("./chunk-H4HPFM5S.js").then(t=>t.RequestsComponent)},{path:"qr-scanner",loadComponent:()=>import("./chunk-RIYAG5LZ.js").then(t=>t.QrScannerComponent)},{path:"users",loadComponent:()=>import("./chunk-NBZYK3PR.js").then(t=>t.UsersRolesComponent)},{path:"sms",loadComponent:()=>import("./chunk-VPXSEFT5.js").then(t=>t.AdminSmsBroadcastComponent)},{path:"email",loadComponent:()=>import("./chunk-HXJ5YULU.js").then(t=>t.AdminEmailBroadcastComponent)},{path:"audit-log",loadComponent:()=>import("./chunk-KQNM75P4.js").then(t=>t.AuditLogComponent)},{path:"settings",loadComponent:()=>import("./chunk-2CGZHSED.js").then(t=>t.SettingsComponent)}]},{path:"resident",canActivate:[k,S],data:{role:"resident"},loadComponent:()=>import("./chunk-DZIS5HL3.js").then(t=>t.ResidentLayoutComponent),children:[{path:"",redirectTo:"dashboard",pathMatch:"full"},{path:"dashboard",loadComponent:()=>import("./chunk-5ZTEVE3P.js").then(t=>t.ResidentDashboardComponent)},{path:"profile",loadComponent:()=>import("./chunk-LI3YGSLT.js").then(t=>t.MyProfileComponent)},{path:"request-certificate",loadComponent:()=>import("./chunk-COI6LZHO.js").then(t=>t.RequestCertificateComponent)},{path:"reports",loadComponent:()=>import("./chunk-VACBEUGF.js").then(t=>t.ResidentReportsComponent)},{path:"requests/:id",loadComponent:()=>import("./chunk-6556AIHD.js").then(t=>t.ResidentRequestDetailComponent)},{path:"requests",loadComponent:()=>import("./chunk-2RRM3WCR.js").then(t=>t.MyRequestsComponent)},{path:"settings",loadComponent:()=>import("./chunk-64OGYNBY.js").then(t=>t.ResidentSettingsComponent)}]},{path:"**",redirectTo:"login"}];var Z={providers:[H({eventCoalescing:!0}),z(Y),B(),$(F())]};var J=(()=>{class t{transform(o){switch(o){case"success":return"Success";case"warning":return"Warning";case"error":return"Error";default:return"Notification"}}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275pipe=M({name:"notificationTypeLabel",type:t,pure:!0})}}return t})();var tt=(t,n,o,e)=>({"global-notifications__item--unread":t,"global-notifications__item--type-success":n,"global-notifications__item--type-error":o,"global-notifications__item--type-warning":e}),ot=(t,n)=>n.id;function et(t,n){if(t&1&&(a(0,"span",3),p(1),r()),t&2){let o=l(2);s(),E(o.unreadCount>9?"9+":o.unreadCount)}}function it(t,n){if(t&1){let o=x();a(0,"button",13),C("click",function(){f(o);let i=l(3);return _(i.markAllAsRead())}),p(1," Mark all as read "),r()}}function nt(t,n){t&1&&(a(0,"p",10),p(1,"No notifications yet."),r())}function at(t,n){if(t&1){let o=x();a(0,"li",15),C("click",function(){let i=f(o).$implicit,d=l(4);return _(d.markAsRead(i.id))}),a(1,"div",16)(2,"span",17),p(3),R(4,"notificationTypeLabel"),r(),a(5,"span",18),p(6),R(7,"date"),r()(),a(8,"p",19),p(9),r()()}if(t&2){let o=n.$implicit;O("ngClass",D(9,tt,!o.read,o.type==="success",o.type==="error",o.type==="warning")),s(3),v(" ",o.title||V(4,4,o.type)," "),s(3),v(" ",G(7,6,o.createdAt,"shortTime")," "),s(3),v(" ",o.message," ")}}function rt(t,n){if(t&1&&(a(0,"ul",11),T(1,at,10,14,"li",14,ot),r()),t&2){let o=l(3);s(),N(o.notifications)}}function st(t,n){if(t&1){let o=x();a(0,"div",4)(1,"div",5)(2,"span",6),p(3,"Notifications"),r(),h(4,it,2,0,"button",7),a(5,"button",8),C("click",function(){f(o);let i=l(2);return _(i.closeNotifications())}),p(6," \u2715 "),r()(),a(7,"div",9),h(8,nt,2,0,"p",10)(9,rt,3,0,"ul",11),r()(),a(10,"button",12),C("click",function(){f(o);let i=l(2);return _(i.closeNotifications())}),r()}if(t&2){let o=l(2);b("aria-label","Notifications"),s(4),u(o.notifications.length?4:-1),s(),b("aria-label","Close notifications"),s(3),u(o.notifications.length?9:8),s(2),b("aria-label","Close notifications")}}function lt(t,n){if(t&1){let o=x();a(0,"div",0)(1,"button",1),C("click",function(){f(o);let i=l();return _(i.toggleNotifications())}),a(2,"span",2),p(3,"\u{1F514}"),r(),h(4,et,2,1,"span",3),r(),h(5,st,11,5),r()}if(t&2){let o=l();s(),b("aria-label","Notifications")("aria-expanded",o.showNotifications),s(3),u(o.unreadCount>0?4:-1),s(),u(o.showNotifications?5:-1)}}var K=(()=>{class t{constructor(o,e){this.router=o,this.notificationsService=e,this.title="Barangay Resident Information Management System",this.unreadCount=0,this.showNotifications=!1,this.showGlobalUi=!0,this.notifications=[],this.updateGlobalUi(this.router.url),this.router.events.subscribe(i=>{i instanceof W&&this.updateGlobalUi(i.urlAfterRedirects)})}ngOnInit(){this.notificationsSub=this.notificationsService.notifications$.subscribe(o=>{this.notifications=o,this.unreadCount=this.notificationsService.unreadCount})}ngOnDestroy(){this.notificationsSub?.unsubscribe()}toggleNotifications(){this.showNotifications=!this.showNotifications}closeNotifications(){this.showNotifications=!1}markAsRead(o){this.notificationsService.markAsRead(o)}markAllAsRead(){this.notificationsService.markAllAsRead()}updateGlobalUi(o){let e=o.startsWith("/staff/requests/")&&o!=="/staff/requests",i=o.startsWith("/resident/requests/")&&o!=="/resident/requests",d=/^\/staff\/residents\/[^/]+$/.test(o),y=o.includes("/qr-scanner"),c=o.startsWith("/staff/households/map");this.showGlobalUi=!o.startsWith("/login")&&!o.startsWith("/forgot-password")&&!o.startsWith("/reset-password")&&!o.includes("/settings")&&!o.includes("/residents/add")&&!o.includes("/households/add")&&!(o.includes("/households/")&&o.includes("/edit"))&&!d&&!e&&!i&&!y&&!c,this.showGlobalUi||(this.showNotifications=!1)}static{this.\u0275fac=function(e){return new(e||t)(A(g),A(Q))}}static{this.\u0275cmp=P({type:t,selectors:[["app-root"]],decls:2,vars:1,consts:[[1,"global-notifications"],["type","button",1,"global-notifications__bell",3,"click"],["aria-hidden","true",1,"global-notifications__icon"],[1,"global-notifications__badge"],["role","dialog",1,"global-notifications__panel"],[1,"global-notifications__panelHeader"],[1,"global-notifications__panelTitle"],["type","button",1,"global-notifications__markAll"],["type","button",1,"global-notifications__close",3,"click"],[1,"global-notifications__panelBody"],[1,"global-notifications__empty"],[1,"global-notifications__list"],["type","button","tabindex","-1",1,"global-notifications__backdrop",3,"click"],["type","button",1,"global-notifications__markAll",3,"click"],[1,"global-notifications__item",3,"ngClass"],[1,"global-notifications__item",3,"click","ngClass"],[1,"global-notifications__itemHeader"],[1,"global-notifications__itemTitle"],[1,"global-notifications__itemTime"],[1,"global-notifications__itemMessage"]],template:function(e,i){e&1&&(q(0,"router-outlet"),h(1,lt,6,4,"div",0)),e&2&&(s(),u(i.showGlobalUi?1:-1))},dependencies:[j,I,L,J],styles:["[_nghost-%COMP%]{display:block}.global-notifications[_ngcontent-%COMP%]{position:fixed;top:24px;right:76px;z-index:1100}@media(max-width:640px){.global-notifications[_ngcontent-%COMP%]{top:20px;right:68px}}.global-notifications__bell[_ngcontent-%COMP%]{position:relative;display:inline-flex;align-items:center;justify-content:center;width:44px;height:44px;border:1px solid var(--color-border);border-radius:9999px;background:var(--color-bg-card);color:var(--color-text);box-shadow:var(--shadow-lg);cursor:pointer;transition:background .2s,transform .05s}@media(max-width:640px){.global-notifications__bell[_ngcontent-%COMP%]{width:40px;height:40px}}.global-notifications__bell[_ngcontent-%COMP%]:hover{background:var(--color-bg)}.global-notifications__bell[_ngcontent-%COMP%]:active{transform:translateY(1px)}.global-notifications__icon[_ngcontent-%COMP%]{font-size:1.25rem;line-height:1;filter:var(--notification-icon-filter)}.global-notifications__badge[_ngcontent-%COMP%]{position:absolute;top:0;right:0;transform:translate(35%,-35%);min-width:18px;padding:2px 6px;border-radius:9999px;background:var(--color-warning);color:#fff;font-size:.75rem;font-weight:700;text-align:center;line-height:1.4;box-shadow:var(--shadow)}.global-notifications__panel[_ngcontent-%COMP%]{position:absolute;top:52px;right:0;width:min(360px,100vw - 32px);background:var(--color-bg-card);border:1px solid var(--color-border);border-radius:var(--radius-lg);box-shadow:var(--shadow-lg);overflow:hidden;z-index:1102}@media(max-width:640px){.global-notifications__panel[_ngcontent-%COMP%]{top:48px;right:-12px;width:calc(100vw - 24px);max-width:360px}}.global-notifications__panelHeader[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid var(--color-border)}.global-notifications__panelTitle[_ngcontent-%COMP%]{font-weight:600;color:var(--color-text)}.global-notifications__close[_ngcontent-%COMP%]{border:none;background:transparent;cursor:pointer;border-radius:var(--radius);padding:6px 8px;color:var(--color-text-muted)}.global-notifications__close[_ngcontent-%COMP%]:hover{background:var(--color-bg);color:var(--color-text)}.global-notifications__panelBody[_ngcontent-%COMP%]{padding:12px 14px}.global-notifications__empty[_ngcontent-%COMP%]{margin:0;color:var(--color-text-muted);font-size:.9375rem}.global-notifications__backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:transparent;border:none;cursor:default;z-index:1101}"]})}}return t})();U(K,Z).catch(t=>console.error(t));
